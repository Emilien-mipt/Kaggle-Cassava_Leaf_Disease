Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select Bi-TemperedLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.3072             avg_val_loss: 0.2927  time: 305s
Epoch 1 - Accuracy: 0.8100467289719626 - F1-score 0.8011504255923685
Epoch 1 - Save Best Accuracy: 0.8100 -                 Save Best F1-score: 0.8012 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.2586             avg_val_loss: 0.2145  time: 312s
Epoch 2 - Accuracy: 0.8563084112149533 - F1-score 0.857446235105127
Epoch 2 - Save Best Accuracy: 0.8563 -                 Save Best F1-score: 0.8574 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.2422             avg_val_loss: 0.2100  time: 313s
Epoch 3 - Accuracy: 0.858411214953271 - F1-score 0.8551569548454909
Number of bad epochs 1
Epoch 4 - avg_train_loss: 0.2352             avg_val_loss: 0.2049  time: 313s
Epoch 4 - Accuracy: 0.8614485981308411 - F1-score 0.8607758921834684
Epoch 4 - Save Best Accuracy: 0.8614 -                 Save Best F1-score: 0.8608 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 0.2273             avg_val_loss: 0.2073  time: 313s
Epoch 5 - Accuracy: 0.8644859813084113 - F1-score 0.8623070378950938
Epoch 5 - Save Best Accuracy: 0.8645 -                 Save Best F1-score: 0.8623 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.2231             avg_val_loss: 0.2383  time: 304s
Epoch 6 - Accuracy: 0.8343457943925233 - F1-score 0.8351756374999607
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.2195             avg_val_loss: 0.1948  time: 314s
Epoch 7 - Accuracy: 0.8682242990654205 - F1-score 0.8675824016247617
Epoch 7 - Save Best Accuracy: 0.8682 -                 Save Best F1-score: 0.8676 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 0.2154             avg_val_loss: 0.2050  time: 312s
Epoch 8 - Accuracy: 0.8661214953271028 - F1-score 0.8679956942493763
Number of bad epochs 1
Epoch 9 - avg_train_loss: 0.2142             avg_val_loss: 0.2075  time: 308s
Epoch 9 - Accuracy: 0.8626168224299066 - F1-score 0.8594607811021178
Number of bad epochs 2
Epoch 10 - avg_train_loss: 0.2118             avg_val_loss: 0.2001  time: 313s
Epoch 10 - Accuracy: 0.8661214953271028 - F1-score 0.8658790539425609
Number of bad epochs 3
Epoch 11 - avg_train_loss: 0.2071             avg_val_loss: 0.1881  time: 314s
Epoch 11 - Accuracy: 0.8782710280373832 - F1-score 0.8764836384250618
Epoch 11 - Save Best Accuracy: 0.8783 -                 Save Best F1-score: 0.8765 Model
Number of bad epochs 0
Epoch 12 - avg_train_loss: 0.2043             avg_val_loss: 0.1901  time: 314s
Epoch 12 - Accuracy: 0.8712616822429906 - F1-score 0.8689648900642917
Number of bad epochs 1
Epoch 13 - avg_train_loss: 0.2018             avg_val_loss: 0.1908  time: 313s
Epoch 13 - Accuracy: 0.8724299065420561 - F1-score 0.8703042926295645
Number of bad epochs 2
Epoch 14 - avg_train_loss: 0.2011             avg_val_loss: 0.1970  time: 314s
Epoch 14 - Accuracy: 0.8707943925233644 - F1-score 0.8718751878310954
Number of bad epochs 3
Epoch 15 - avg_train_loss: 0.1957             avg_val_loss: 0.1872  time: 313s
Epoch 15 - Accuracy: 0.8775700934579439 - F1-score 0.8783224252169707
Number of bad epochs 4
Epoch 16 - avg_train_loss: 0.1964             avg_val_loss: 0.2054  time: 314s
Epoch 16 - Accuracy: 0.8658878504672897 - F1-score 0.8621346828606337
Number of bad epochs 5
Epoch 17 - avg_train_loss: 0.1972             avg_val_loss: 0.1931  time: 314s
Epoch 17 - Accuracy: 0.8698598130841122 - F1-score 0.8703215923686755
Number of bad epochs 6
Epoch 18 - avg_train_loss: 0.1944             avg_val_loss: 0.2009  time: 314s
Epoch 18 - Accuracy: 0.866822429906542 - F1-score 0.8668079209884022
Number of bad epochs 7
Epoch 19 - avg_train_loss: 0.1921             avg_val_loss: 0.2034  time: 314s
Epoch 19 - Accuracy: 0.8616822429906542 - F1-score 0.8642433373774203
Number of bad epochs 8
Epoch 20 - avg_train_loss: 0.1891             avg_val_loss: 0.1958  time: 314s
Epoch 20 - Accuracy: 0.8661214953271028 - F1-score 0.8668880271793187
Number of bad epochs 9
Epoch 21 - avg_train_loss: 0.1898             avg_val_loss: 0.1786  time: 314s
Epoch 21 - Accuracy: 0.8803738317757009 - F1-score 0.8795020259668012
Epoch 21 - Save Best Accuracy: 0.8804 -                 Save Best F1-score: 0.8795 Model
Number of bad epochs 0
Epoch 22 - avg_train_loss: 0.1874             avg_val_loss: 0.1963  time: 314s
Epoch 22 - Accuracy: 0.8684579439252337 - F1-score 0.8679800623733096
Number of bad epochs 1
Epoch 23 - avg_train_loss: 0.1841             avg_val_loss: 0.1781  time: 314s
Epoch 23 - Accuracy: 0.8822429906542056 - F1-score 0.881361766852601
Epoch 23 - Save Best Accuracy: 0.8822 -                 Save Best F1-score: 0.8814 Model
Number of bad epochs 0
Epoch 24 - avg_train_loss: 0.1833             avg_val_loss: 0.1944  time: 314s
Epoch 24 - Accuracy: 0.869392523364486 - F1-score 0.8710398853101774
Number of bad epochs 1
Epoch 25 - avg_train_loss: 0.1822             avg_val_loss: 0.2012  time: 314s
Epoch 25 - Accuracy: 0.8623831775700934 - F1-score 0.864432821247317
Number of bad epochs 2
Epoch 26 - avg_train_loss: 0.1794             avg_val_loss: 0.1920  time: 314s
Epoch 26 - Accuracy: 0.8728971962616823 - F1-score 0.871418391882142
Number of bad epochs 3
Epoch 27 - avg_train_loss: 0.1810             avg_val_loss: 0.1875  time: 314s
Epoch 27 - Accuracy: 0.8733644859813084 - F1-score 0.872542370726901
Number of bad epochs 4
Epoch 28 - avg_train_loss: 0.1805             avg_val_loss: 0.1837  time: 314s
Epoch 28 - Accuracy: 0.872196261682243 - F1-score 0.8725108145140271
Number of bad epochs 5
Epoch 29 - avg_train_loss: 0.1773             avg_val_loss: 0.1844  time: 314s
Epoch 29 - Accuracy: 0.8775700934579439 - F1-score 0.8760148725545659
Number of bad epochs 6
Epoch 30 - avg_train_loss: 0.1770             avg_val_loss: 0.1930  time: 314s
Epoch 30 - Accuracy: 0.8726635514018691 - F1-score 0.8698443915959951
Number of bad epochs 7
Epoch 31 - avg_train_loss: 0.1766             avg_val_loss: 0.1855  time: 314s
Epoch 31 - Accuracy: 0.875233644859813 - F1-score 0.8749552659605809
Number of bad epochs 8
Epoch 32 - avg_train_loss: 0.1745             avg_val_loss: 0.1914  time: 314s
Epoch 32 - Accuracy: 0.8719626168224299 - F1-score 0.872667490675958
Number of bad epochs 9
Epoch 33 - avg_train_loss: 0.1700             avg_val_loss: 0.1877  time: 314s
Epoch 33 - Accuracy: 0.8757009345794392 - F1-score 0.8747664413351612
Number of bad epochs 10
Epoch 34 - avg_train_loss: 0.1726             avg_val_loss: 0.1838  time: 314s
Epoch 34 - Accuracy: 0.8771028037383177 - F1-score 0.8765776775875103
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 23: Best Accuracy: 0.8822 -                 Best F1-score: 0.8814
