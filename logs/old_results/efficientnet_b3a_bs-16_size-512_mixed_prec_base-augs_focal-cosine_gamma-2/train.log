Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select FocalCosineLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.2332             avg_val_loss: 0.1820  time: 308s
Epoch 1 - Accuracy: 0.8425233644859813 - F1-score 0.8412786827606261
Epoch 1 - Save Best Accuracy: 0.8425 -                 Save Best F1-score: 0.8413 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.1993             avg_val_loss: 0.1687  time: 315s
Epoch 2 - Accuracy: 0.8553738317757009 - F1-score 0.8521105037260356
Epoch 2 - Save Best Accuracy: 0.8554 -                 Save Best F1-score: 0.8521 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.1897             avg_val_loss: 0.1894  time: 316s
Epoch 3 - Accuracy: 0.8350467289719626 - F1-score 0.8349152930743485
Number of bad epochs 1
Epoch 4 - avg_train_loss: 0.1841             avg_val_loss: 0.1883  time: 317s
Epoch 4 - Accuracy: 0.836214953271028 - F1-score 0.8278753135581699
Number of bad epochs 2
Epoch 5 - avg_train_loss: 0.1775             avg_val_loss: 0.1622  time: 317s
Epoch 5 - Accuracy: 0.8635514018691589 - F1-score 0.8629392977891307
Epoch 5 - Save Best Accuracy: 0.8636 -                 Save Best F1-score: 0.8629 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.1785             avg_val_loss: 0.1903  time: 317s
Epoch 6 - Accuracy: 0.8336448598130841 - F1-score 0.8394019623066126
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.1724             avg_val_loss: 0.1639  time: 317s
Epoch 7 - Accuracy: 0.8621495327102804 - F1-score 0.8618453516365991
Number of bad epochs 2
Epoch 8 - avg_train_loss: 0.1730             avg_val_loss: 0.1617  time: 317s
Epoch 8 - Accuracy: 0.8637850467289719 - F1-score 0.8655607625692799
Epoch 8 - Save Best Accuracy: 0.8638 -                 Save Best F1-score: 0.8656 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 0.1728             avg_val_loss: 0.1559  time: 317s
Epoch 9 - Accuracy: 0.8691588785046729 - F1-score 0.8695039368947245
Epoch 9 - Save Best Accuracy: 0.8692 -                 Save Best F1-score: 0.8695 Model
Number of bad epochs 0
Epoch 10 - avg_train_loss: 0.1661             avg_val_loss: 0.1580  time: 317s
Epoch 10 - Accuracy: 0.8656542056074766 - F1-score 0.8622553868952059
Number of bad epochs 1
Epoch 11 - avg_train_loss: 0.1659             avg_val_loss: 0.1525  time: 317s
Epoch 11 - Accuracy: 0.8717289719626168 - F1-score 0.8689480200235666
Number of bad epochs 2
Epoch 12 - avg_train_loss: 0.1646             avg_val_loss: 0.1499  time: 317s
Epoch 12 - Accuracy: 0.8771028037383177 - F1-score 0.8749441962164795
Epoch 12 - Save Best Accuracy: 0.8771 -                 Save Best F1-score: 0.8749 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 0.1637             avg_val_loss: 0.1520  time: 317s
Epoch 13 - Accuracy: 0.8745327102803738 - F1-score 0.8740636371773326
Number of bad epochs 1
Epoch 14 - avg_train_loss: 0.1605             avg_val_loss: 0.1516  time: 317s
Epoch 14 - Accuracy: 0.8742990654205608 - F1-score 0.8746397346975027
Number of bad epochs 2
Epoch 15 - avg_train_loss: 0.1587             avg_val_loss: 0.1542  time: 317s
Epoch 15 - Accuracy: 0.8698598130841122 - F1-score 0.8684946445863079
Number of bad epochs 3
Epoch 16 - avg_train_loss: 0.1602             avg_val_loss: 0.1555  time: 317s
Epoch 16 - Accuracy: 0.8679906542056075 - F1-score 0.8650376365177037
Number of bad epochs 4
Epoch 17 - avg_train_loss: 0.1599             avg_val_loss: 0.1580  time: 317s
Epoch 17 - Accuracy: 0.8647196261682243 - F1-score 0.8635303158706077
Number of bad epochs 5
Epoch 18 - avg_train_loss: 0.1566             avg_val_loss: 0.1499  time: 317s
Epoch 18 - Accuracy: 0.8724299065420561 - F1-score 0.871167668370485
Number of bad epochs 6
Epoch 19 - avg_train_loss: 0.1574             avg_val_loss: 0.1549  time: 317s
Epoch 19 - Accuracy: 0.8691588785046729 - F1-score 0.8694147302488784
Number of bad epochs 7
Epoch 20 - avg_train_loss: 0.1558             avg_val_loss: 0.1652  time: 317s
Epoch 20 - Accuracy: 0.8644859813084113 - F1-score 0.8639330969444667
Number of bad epochs 8
Epoch 21 - avg_train_loss: 0.1550             avg_val_loss: 0.1490  time: 317s
Epoch 21 - Accuracy: 0.8757009345794392 - F1-score 0.8759669301988944
Number of bad epochs 9
Epoch 22 - avg_train_loss: 0.1533             avg_val_loss: 0.1568  time: 317s
Epoch 22 - Accuracy: 0.8698598130841122 - F1-score 0.8691450862985621
Number of bad epochs 10
Epoch 23 - avg_train_loss: 0.1521             avg_val_loss: 0.1474  time: 317s
Epoch 23 - Accuracy: 0.8766355140186916 - F1-score 0.8777392882752444
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 12: Best Accuracy: 0.8771 -                 Best F1-score: 0.8777
