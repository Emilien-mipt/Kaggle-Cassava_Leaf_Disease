Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.5259             avg_val_loss: 0.4239  time: 308s
Epoch 1 - Accuracy: 0.8579439252336448 - F1-score 0.8583555606176647
Epoch 1 - Save Best Accuracy: 0.8579 -                 Save Best F1-score: 0.8584 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.3970             avg_val_loss: 0.4574  time: 315s
Epoch 2 - Accuracy: 0.8509345794392523 - F1-score 0.8499605763166783
Number of bad epochs 1
Epoch 3 - avg_train_loss: 0.3377             avg_val_loss: 0.3944  time: 316s
Epoch 3 - Accuracy: 0.8738317757009346 - F1-score 0.8716314953681045
Epoch 3 - Save Best Accuracy: 0.8738 -                 Save Best F1-score: 0.8716 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.2816             avg_val_loss: 0.4547  time: 316s
Epoch 4 - Accuracy: 0.8492990654205608 - F1-score 0.8541231525615958
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.2336             avg_val_loss: 0.4926  time: 316s
Epoch 5 - Accuracy: 0.858411214953271 - F1-score 0.8546769311596966
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.1880             avg_val_loss: 0.5110  time: 316s
Epoch 6 - Accuracy: 0.8556074766355141 - F1-score 0.8511091106364096
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.1501             avg_val_loss: 0.5888  time: 316s
Epoch 7 - Accuracy: 0.8523364485981308 - F1-score 0.8525240407595873
Number of bad epochs 4
Epoch 8 - avg_train_loss: 0.1170             avg_val_loss: 0.6226  time: 316s
Epoch 8 - Accuracy: 0.8373831775700935 - F1-score 0.8413413642696297
Number of bad epochs 5
Epoch 9 - avg_train_loss: 0.1064             avg_val_loss: 0.6784  time: 316s
Epoch 9 - Accuracy: 0.8516355140186916 - F1-score 0.8480633742198058
Number of bad epochs 6
Epoch 10 - avg_train_loss: 0.0894             avg_val_loss: 0.6465  time: 316s
Epoch 10 - Accuracy: 0.8504672897196262 - F1-score 0.8529264864180641
Number of bad epochs 7
Epoch 11 - avg_train_loss: 0.0753             avg_val_loss: 0.6474  time: 316s
Epoch 11 - Accuracy: 0.8563084112149533 - F1-score 0.8545921918196961
Number of bad epochs 8
Epoch 12 - avg_train_loss: 0.0751             avg_val_loss: 0.8469  time: 316s
Epoch 12 - Accuracy: 0.8457943925233645 - F1-score 0.8383167350546942
Number of bad epochs 9
Epoch 13 - avg_train_loss: 0.0680             avg_val_loss: 0.7011  time: 316s
Epoch 13 - Accuracy: 0.85 - F1-score 0.8488868108778063
Number of bad epochs 10
Epoch 14 - avg_train_loss: 0.0640             avg_val_loss: 0.7427  time: 316s
Epoch 14 - Accuracy: 0.8460280373831776 - F1-score 0.8487551239344816
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 3: Best Accuracy: 0.8738 -                 Best F1-score: 0.8716
