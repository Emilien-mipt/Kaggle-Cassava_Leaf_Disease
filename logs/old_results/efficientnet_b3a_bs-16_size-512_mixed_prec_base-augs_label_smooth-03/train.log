Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.2344             avg_val_loss: 1.1980  time: 305s
Epoch 1 - Accuracy: 0.8355140186915888 - F1-score 0.829641985593419
Epoch 1 - Save Best Accuracy: 0.8355 -                 Save Best F1-score: 0.8296 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.1979             avg_val_loss: 1.1748  time: 312s
Epoch 2 - Accuracy: 0.8588785046728972 - F1-score 0.8564100114468812
Epoch 2 - Save Best Accuracy: 0.8589 -                 Save Best F1-score: 0.8564 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 1.1858             avg_val_loss: 1.1723  time: 313s
Epoch 3 - Accuracy: 0.8591121495327103 - F1-score 0.858855236451352
Epoch 3 - Save Best Accuracy: 0.8591 -                 Save Best F1-score: 0.8589 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 1.1809             avg_val_loss: 1.1729  time: 313s
Epoch 4 - Accuracy: 0.8598130841121495 - F1-score 0.8608451879631484
Epoch 4 - Save Best Accuracy: 0.8598 -                 Save Best F1-score: 0.8608 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 1.1764             avg_val_loss: 1.1646  time: 313s
Epoch 5 - Accuracy: 0.869392523364486 - F1-score 0.8698728982000766
Epoch 5 - Save Best Accuracy: 0.8694 -                 Save Best F1-score: 0.8699 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 1.1734             avg_val_loss: 1.1938  time: 313s
Epoch 6 - Accuracy: 0.8331775700934579 - F1-score 0.8343642318539095
Number of bad epochs 1
Epoch 7 - avg_train_loss: 1.1700             avg_val_loss: 1.1583  time: 313s
Epoch 7 - Accuracy: 0.8654205607476636 - F1-score 0.8661767864369818
Number of bad epochs 2
Epoch 8 - avg_train_loss: 1.1674             avg_val_loss: 1.1577  time: 313s
Epoch 8 - Accuracy: 0.8698598130841122 - F1-score 0.8693694837596844
Number of bad epochs 3
Epoch 9 - avg_train_loss: 1.1659             avg_val_loss: 1.1631  time: 313s
Epoch 9 - Accuracy: 0.8644859813084113 - F1-score 0.8657300901496502
Number of bad epochs 4
Epoch 10 - avg_train_loss: 1.1617             avg_val_loss: 1.1562  time: 313s
Epoch 10 - Accuracy: 0.8799065420560748 - F1-score 0.8784851005638558
Epoch 10 - Save Best Accuracy: 0.8799 -                 Save Best F1-score: 0.8785 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 1.1616             avg_val_loss: 1.1572  time: 313s
Epoch 11 - Accuracy: 0.8785046728971962 - F1-score 0.8774744087934047
Number of bad epochs 1
Epoch 12 - avg_train_loss: 1.1587             avg_val_loss: 1.1493  time: 313s
Epoch 12 - Accuracy: 0.8829439252336448 - F1-score 0.8797907616863113
Epoch 12 - Save Best Accuracy: 0.8829 -                 Save Best F1-score: 0.8798 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 1.1573             avg_val_loss: 1.1546  time: 313s
Epoch 13 - Accuracy: 0.8728971962616823 - F1-score 0.8726686304063093
Number of bad epochs 1
Epoch 14 - avg_train_loss: 1.1552             avg_val_loss: 1.1592  time: 313s
Epoch 14 - Accuracy: 0.8707943925233644 - F1-score 0.8732018951180763
Number of bad epochs 2
Epoch 15 - avg_train_loss: 1.1541             avg_val_loss: 1.1476  time: 313s
Epoch 15 - Accuracy: 0.8799065420560748 - F1-score 0.8796938393298829
Number of bad epochs 3
Epoch 16 - avg_train_loss: 1.1527             avg_val_loss: 1.1494  time: 313s
Epoch 16 - Accuracy: 0.875233644859813 - F1-score 0.8743855668623152
Number of bad epochs 4
Epoch 17 - avg_train_loss: 1.1540             avg_val_loss: 1.1519  time: 311s
Epoch 17 - Accuracy: 0.8771028037383177 - F1-score 0.8765500332516155
Number of bad epochs 5
Epoch 18 - avg_train_loss: 1.1512             avg_val_loss: 1.1473  time: 308s
Epoch 18 - Accuracy: 0.8813084112149533 - F1-score 0.8806463321037785
Number of bad epochs 6
Epoch 19 - avg_train_loss: 1.1507             avg_val_loss: 1.1502  time: 303s
Epoch 19 - Accuracy: 0.8761682242990654 - F1-score 0.877331515184046
Number of bad epochs 7
Epoch 20 - avg_train_loss: 1.1491             avg_val_loss: 1.1563  time: 312s
Epoch 20 - Accuracy: 0.8714953271028038 - F1-score 0.8708625731774036
Number of bad epochs 8
Epoch 21 - avg_train_loss: 1.1486             avg_val_loss: 1.1475  time: 315s
Epoch 21 - Accuracy: 0.8827102803738318 - F1-score 0.8817940558270658
Number of bad epochs 9
Epoch 22 - avg_train_loss: 1.1475             avg_val_loss: 1.1576  time: 314s
Epoch 22 - Accuracy: 0.8738317757009346 - F1-score 0.8731028817309264
Number of bad epochs 10
Epoch 23 - avg_train_loss: 1.1459             avg_val_loss: 1.1508  time: 314s
Epoch 23 - Accuracy: 0.8813084112149533 - F1-score 0.8814589223641196
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 12: Best Accuracy: 0.8829 -                 Best F1-score: 0.8818
