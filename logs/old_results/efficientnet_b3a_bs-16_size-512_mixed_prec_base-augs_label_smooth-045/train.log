Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.4188             avg_val_loss: 1.3981  time: 304s
Epoch 1 - Accuracy: 0.8394859813084112 - F1-score 0.8402573660486083
Epoch 1 - Save Best Accuracy: 0.8395 -                 Save Best F1-score: 0.8403 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.4005             avg_val_loss: 1.3858  time: 312s
Epoch 2 - Accuracy: 0.8593457943925233 - F1-score 0.8565202996775322
Epoch 2 - Save Best Accuracy: 0.8593 -                 Save Best F1-score: 0.8565 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 1.3946             avg_val_loss: 1.3823  time: 313s
Epoch 3 - Accuracy: 0.8626168224299066 - F1-score 0.8606241007261609
Epoch 3 - Save Best Accuracy: 0.8626 -                 Save Best F1-score: 0.8606 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 1.3922             avg_val_loss: 1.3853  time: 313s
Epoch 4 - Accuracy: 0.8619158878504672 - F1-score 0.8624300760514693
Number of bad epochs 1
Epoch 5 - avg_train_loss: 1.3899             avg_val_loss: 1.3849  time: 313s
Epoch 5 - Accuracy: 0.8677570093457944 - F1-score 0.8673482091563096
Epoch 5 - Save Best Accuracy: 0.8678 -                 Save Best F1-score: 0.8673 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 1.3883             avg_val_loss: 1.3860  time: 313s
Epoch 6 - Accuracy: 0.8537383177570094 - F1-score 0.8530210756748324
Number of bad epochs 1
Epoch 7 - avg_train_loss: 1.3866             avg_val_loss: 1.3782  time: 313s
Epoch 7 - Accuracy: 0.8696261682242991 - F1-score 0.8695757359918163
Epoch 7 - Save Best Accuracy: 0.8696 -                 Save Best F1-score: 0.8696 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 1.3851             avg_val_loss: 1.3786  time: 313s
Epoch 8 - Accuracy: 0.8771028037383177 - F1-score 0.877372105981906
Epoch 8 - Save Best Accuracy: 0.8771 -                 Save Best F1-score: 0.8774 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 1.3846             avg_val_loss: 1.3810  time: 313s
Epoch 9 - Accuracy: 0.8651869158878505 - F1-score 0.86681152596885
Number of bad epochs 1
Epoch 10 - avg_train_loss: 1.3823             avg_val_loss: 1.3794  time: 313s
Epoch 10 - Accuracy: 0.8707943925233644 - F1-score 0.8698866817119961
Number of bad epochs 2
Epoch 11 - avg_train_loss: 1.3816             avg_val_loss: 1.3770  time: 313s
Epoch 11 - Accuracy: 0.8775700934579439 - F1-score 0.876336316589629
Number of bad epochs 3
Epoch 12 - avg_train_loss: 1.3815             avg_val_loss: 1.3757  time: 313s
Epoch 12 - Accuracy: 0.8794392523364486 - F1-score 0.877141405044044
Number of bad epochs 4
Epoch 13 - avg_train_loss: 1.3801             avg_val_loss: 1.3776  time: 313s
Epoch 13 - Accuracy: 0.872196261682243 - F1-score 0.8723401886800614
Number of bad epochs 5
Epoch 14 - avg_train_loss: 1.3797             avg_val_loss: 1.3830  time: 313s
Epoch 14 - Accuracy: 0.8677570093457944 - F1-score 0.8681496238996824
Number of bad epochs 6
Epoch 15 - avg_train_loss: 1.3778             avg_val_loss: 1.3744  time: 313s
Epoch 15 - Accuracy: 0.877803738317757 - F1-score 0.8772405248880992
Number of bad epochs 7
Epoch 16 - avg_train_loss: 1.3780             avg_val_loss: 1.3762  time: 313s
Epoch 16 - Accuracy: 0.877803738317757 - F1-score 0.876280885038324
Number of bad epochs 8
Epoch 17 - avg_train_loss: 1.3781             avg_val_loss: 1.3779  time: 313s
Epoch 17 - Accuracy: 0.874766355140187 - F1-score 0.8731277578688881
Number of bad epochs 9
Epoch 18 - avg_train_loss: 1.3768             avg_val_loss: 1.3773  time: 313s
Epoch 18 - Accuracy: 0.8740654205607477 - F1-score 0.8739487544967384
Number of bad epochs 10
Epoch 19 - avg_train_loss: 1.3765             avg_val_loss: 1.3742  time: 313s
Epoch 19 - Accuracy: 0.8845794392523364 - F1-score 0.8837705250437116
Epoch 19 - Save Best Accuracy: 0.8846 -                 Save Best F1-score: 0.8838 Model
Number of bad epochs 0
Epoch 20 - avg_train_loss: 1.3757             avg_val_loss: 1.3770  time: 313s
Epoch 20 - Accuracy: 0.874766355140187 - F1-score 0.8734074872317208
Number of bad epochs 1
Epoch 21 - avg_train_loss: 1.3758             avg_val_loss: 1.3724  time: 313s
Epoch 21 - Accuracy: 0.883177570093458 - F1-score 0.8817281486318973
Number of bad epochs 2
Epoch 22 - avg_train_loss: 1.3748             avg_val_loss: 1.3795  time: 313s
Epoch 22 - Accuracy: 0.8712616822429906 - F1-score 0.871444870861468
Number of bad epochs 3
Epoch 23 - avg_train_loss: 1.3742             avg_val_loss: 1.3728  time: 313s
Epoch 23 - Accuracy: 0.8803738317757009 - F1-score 0.880414285922143
Number of bad epochs 4
Epoch 24 - avg_train_loss: 1.3733             avg_val_loss: 1.3711  time: 313s
Epoch 24 - Accuracy: 0.8848130841121495 - F1-score 0.8842061674254056
Epoch 24 - Save Best Accuracy: 0.8848 -                 Save Best F1-score: 0.8842 Model
Number of bad epochs 0
Epoch 25 - avg_train_loss: 1.3733             avg_val_loss: 1.3840  time: 313s
Epoch 25 - Accuracy: 0.8623831775700934 - F1-score 0.8637293419917605
Number of bad epochs 1
Epoch 26 - avg_train_loss: 1.3721             avg_val_loss: 1.3736  time: 313s
Epoch 26 - Accuracy: 0.8810747663551401 - F1-score 0.8804630996940799
Number of bad epochs 2
Epoch 27 - avg_train_loss: 1.3718             avg_val_loss: 1.3739  time: 313s
Epoch 27 - Accuracy: 0.8829439252336448 - F1-score 0.8800858141807888
Number of bad epochs 3
Epoch 28 - avg_train_loss: 1.3720             avg_val_loss: 1.3760  time: 313s
Epoch 28 - Accuracy: 0.8724299065420561 - F1-score 0.8726623739946862
Number of bad epochs 4
Epoch 29 - avg_train_loss: 1.3713             avg_val_loss: 1.3748  time: 313s
Epoch 29 - Accuracy: 0.8768691588785047 - F1-score 0.8759040523045054
Number of bad epochs 5
Epoch 30 - avg_train_loss: 1.3711             avg_val_loss: 1.3766  time: 313s
Epoch 30 - Accuracy: 0.8771028037383177 - F1-score 0.8754741358326786
Number of bad epochs 6
Epoch 31 - avg_train_loss: 1.3713             avg_val_loss: 1.3772  time: 313s
Epoch 31 - Accuracy: 0.8757009345794392 - F1-score 0.8746221457948875
Number of bad epochs 7
Epoch 32 - avg_train_loss: 1.3699             avg_val_loss: 1.3775  time: 313s
Epoch 32 - Accuracy: 0.8731308411214953 - F1-score 0.8735995196030331
Number of bad epochs 8
Epoch 33 - avg_train_loss: 1.3687             avg_val_loss: 1.3732  time: 313s
Epoch 33 - Accuracy: 0.8841121495327103 - F1-score 0.8839394666408272
Number of bad epochs 9
Epoch 34 - avg_train_loss: 1.3686             avg_val_loss: 1.3748  time: 313s
Epoch 34 - Accuracy: 0.8852803738317757 - F1-score 0.8851322346223707
Epoch 34 - Save Best Accuracy: 0.8853 -                 Save Best F1-score: 0.8851 Model
Number of bad epochs 0
Epoch 35 - avg_train_loss: 1.3683             avg_val_loss: 1.3736  time: 314s
Epoch 35 - Accuracy: 0.8813084112149533 - F1-score 0.8786865298261426
Number of bad epochs 1
Epoch 36 - avg_train_loss: 1.3688             avg_val_loss: 1.3748  time: 313s
Epoch 36 - Accuracy: 0.877803738317757 - F1-score 0.8784891597071517
Number of bad epochs 2
Epoch 37 - avg_train_loss: 1.3675             avg_val_loss: 1.3727  time: 314s
Epoch 37 - Accuracy: 0.8873831775700934 - F1-score 0.8855269197462958
Epoch 37 - Save Best Accuracy: 0.8874 -                 Save Best F1-score: 0.8855 Model
Number of bad epochs 0
Epoch 38 - avg_train_loss: 1.3669             avg_val_loss: 1.3772  time: 314s
Epoch 38 - Accuracy: 0.8724299065420561 - F1-score 0.8714327548876547
Number of bad epochs 1
Epoch 39 - avg_train_loss: 1.3670             avg_val_loss: 1.3736  time: 314s
Epoch 39 - Accuracy: 0.880607476635514 - F1-score 0.8808325895597393
Number of bad epochs 2
Epoch 40 - avg_train_loss: 1.3666             avg_val_loss: 1.3736  time: 314s
Epoch 40 - Accuracy: 0.883177570093458 - F1-score 0.8824867992966224
Number of bad epochs 3
Epoch 41 - avg_train_loss: 1.3659             avg_val_loss: 1.3761  time: 314s
Epoch 41 - Accuracy: 0.8773364485981309 - F1-score 0.8746118554319119
Number of bad epochs 4
Epoch 42 - avg_train_loss: 1.3661             avg_val_loss: 1.3832  time: 314s
Epoch 42 - Accuracy: 0.8679906542056075 - F1-score 0.8651113769416999
Number of bad epochs 5
Epoch 43 - avg_train_loss: 1.3653             avg_val_loss: 1.3731  time: 314s
Epoch 43 - Accuracy: 0.8855140186915887 - F1-score 0.8843598096894353
Number of bad epochs 6
Epoch 44 - avg_train_loss: 1.3650             avg_val_loss: 1.3749  time: 314s
Epoch 44 - Accuracy: 0.8792056074766356 - F1-score 0.8781692605088863
Number of bad epochs 7
Epoch 45 - avg_train_loss: 1.3650             avg_val_loss: 1.3743  time: 314s
Epoch 45 - Accuracy: 0.8789719626168224 - F1-score 0.8758271287461732
Number of bad epochs 8
Epoch 46 - avg_train_loss: 1.3643             avg_val_loss: 1.3738  time: 314s
Epoch 46 - Accuracy: 0.8843457943925234 - F1-score 0.8846696333022496
Number of bad epochs 9
Epoch 47 - avg_train_loss: 1.3637             avg_val_loss: 1.3781  time: 314s
Epoch 47 - Accuracy: 0.874766355140187 - F1-score 0.8724088062129759
Number of bad epochs 10
Epoch 48 - avg_train_loss: 1.3635             avg_val_loss: 1.3798  time: 314s
Epoch 48 - Accuracy: 0.8700934579439252 - F1-score 0.869273429478867
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 37: Best Accuracy: 0.8874 -                 Best F1-score: 0.8855
