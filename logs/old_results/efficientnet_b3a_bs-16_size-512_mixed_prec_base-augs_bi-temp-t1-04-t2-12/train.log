Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select Bi-TemperedLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.2392             avg_val_loss: 0.2056  time: 304s
Epoch 1 - Accuracy: 0.8158878504672897 - F1-score 0.814492657285126
Epoch 1 - Save Best Accuracy: 0.8159 -                 Save Best F1-score: 0.8145 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.1999             avg_val_loss: 0.1789  time: 312s
Epoch 2 - Accuracy: 0.8427570093457943 - F1-score 0.8442050056643121
Epoch 2 - Save Best Accuracy: 0.8428 -                 Save Best F1-score: 0.8442 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.1882             avg_val_loss: 0.1740  time: 313s
Epoch 3 - Accuracy: 0.8464953271028037 - F1-score 0.8467441428056446
Epoch 3 - Save Best Accuracy: 0.8465 -                 Save Best F1-score: 0.8467 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.1823             avg_val_loss: 0.1628  time: 313s
Epoch 4 - Accuracy: 0.8577102803738318 - F1-score 0.8558478021644046
Epoch 4 - Save Best Accuracy: 0.8577 -                 Save Best F1-score: 0.8558 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 0.1780             avg_val_loss: 0.1535  time: 313s
Epoch 5 - Accuracy: 0.8672897196261682 - F1-score 0.8655161130312914
Epoch 5 - Save Best Accuracy: 0.8673 -                 Save Best F1-score: 0.8655 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.1756             avg_val_loss: 0.1713  time: 313s
Epoch 6 - Accuracy: 0.847196261682243 - F1-score 0.8474619238293011
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.1692             avg_val_loss: 0.1607  time: 313s
Epoch 7 - Accuracy: 0.8607476635514019 - F1-score 0.8621930127078007
Number of bad epochs 2
Epoch 8 - avg_train_loss: 0.1679             avg_val_loss: 0.1593  time: 313s
Epoch 8 - Accuracy: 0.861214953271028 - F1-score 0.8639065843859306
Number of bad epochs 3
Epoch 9 - avg_train_loss: 0.1677             avg_val_loss: 0.1615  time: 313s
Epoch 9 - Accuracy: 0.858177570093458 - F1-score 0.8555181777474848
Number of bad epochs 4
Epoch 10 - avg_train_loss: 0.1615             avg_val_loss: 0.1512  time: 313s
Epoch 10 - Accuracy: 0.8682242990654205 - F1-score 0.8653666513530492
Number of bad epochs 5
Epoch 11 - avg_train_loss: 0.1611             avg_val_loss: 0.1504  time: 313s
Epoch 11 - Accuracy: 0.8682242990654205 - F1-score 0.866292993292746
Number of bad epochs 6
Epoch 12 - avg_train_loss: 0.1588             avg_val_loss: 0.1497  time: 313s
Epoch 12 - Accuracy: 0.8757009345794392 - F1-score 0.872532556176612
Epoch 12 - Save Best Accuracy: 0.8757 -                 Save Best F1-score: 0.8725 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 0.1564             avg_val_loss: 0.1551  time: 313s
Epoch 13 - Accuracy: 0.8640186915887851 - F1-score 0.8638444984372501
Number of bad epochs 1
Epoch 14 - avg_train_loss: 0.1548             avg_val_loss: 0.1533  time: 313s
Epoch 14 - Accuracy: 0.8705607476635514 - F1-score 0.8712378282924301
Number of bad epochs 2
Epoch 15 - avg_train_loss: 0.1530             avg_val_loss: 0.1446  time: 313s
Epoch 15 - Accuracy: 0.8724299065420561 - F1-score 0.8699915105632787
Number of bad epochs 3
Epoch 16 - avg_train_loss: 0.1526             avg_val_loss: 0.1487  time: 313s
Epoch 16 - Accuracy: 0.8719626168224299 - F1-score 0.8694630400003849
Number of bad epochs 4
Epoch 17 - avg_train_loss: 0.1541             avg_val_loss: 0.1543  time: 313s
Epoch 17 - Accuracy: 0.866822429906542 - F1-score 0.8636032651428691
Number of bad epochs 5
Epoch 18 - avg_train_loss: 0.1488             avg_val_loss: 0.1453  time: 313s
Epoch 18 - Accuracy: 0.8761682242990654 - F1-score 0.877426537878127
Epoch 18 - Save Best Accuracy: 0.8762 -                 Save Best F1-score: 0.8774 Model
Number of bad epochs 0
Epoch 19 - avg_train_loss: 0.1482             avg_val_loss: 0.1498  time: 313s
Epoch 19 - Accuracy: 0.8712616822429906 - F1-score 0.8731231718204346
Number of bad epochs 1
Epoch 20 - avg_train_loss: 0.1475             avg_val_loss: 0.1447  time: 313s
Epoch 20 - Accuracy: 0.8705607476635514 - F1-score 0.8706540635606842
Number of bad epochs 2
Epoch 21 - avg_train_loss: 0.1462             avg_val_loss: 0.1392  time: 310s
Epoch 21 - Accuracy: 0.8801401869158878 - F1-score 0.8798036742901133
Epoch 21 - Save Best Accuracy: 0.8801 -                 Save Best F1-score: 0.8798 Model
Number of bad epochs 0
Epoch 22 - avg_train_loss: 0.1472             avg_val_loss: 0.1516  time: 309s
Epoch 22 - Accuracy: 0.8712616822429906 - F1-score 0.8706681131630929
Number of bad epochs 1
Epoch 23 - avg_train_loss: 0.1428             avg_val_loss: 0.1424  time: 308s
Epoch 23 - Accuracy: 0.8768691588785047 - F1-score 0.8753040139378776
Number of bad epochs 2
Epoch 24 - avg_train_loss: 0.1436             avg_val_loss: 0.1522  time: 309s
Epoch 24 - Accuracy: 0.866822429906542 - F1-score 0.8682251776375207
Number of bad epochs 3
Epoch 25 - avg_train_loss: 0.1417             avg_val_loss: 0.1603  time: 305s
Epoch 25 - Accuracy: 0.8600467289719627 - F1-score 0.8636864052655638
Number of bad epochs 4
Epoch 26 - avg_train_loss: 0.1405             avg_val_loss: 0.1442  time: 312s
Epoch 26 - Accuracy: 0.875 - F1-score 0.873114421018152
Number of bad epochs 5
Epoch 27 - avg_train_loss: 0.1398             avg_val_loss: 0.1414  time: 308s
Epoch 27 - Accuracy: 0.8775700934579439 - F1-score 0.8756135973631354
Number of bad epochs 6
Epoch 28 - avg_train_loss: 0.1400             avg_val_loss: 0.1449  time: 311s
Epoch 28 - Accuracy: 0.8740654205607477 - F1-score 0.8745883560679896
Number of bad epochs 7
Epoch 29 - avg_train_loss: 0.1387             avg_val_loss: 0.1474  time: 310s
Epoch 29 - Accuracy: 0.8740654205607477 - F1-score 0.8736283896689209
Number of bad epochs 8
Epoch 30 - avg_train_loss: 0.1377             avg_val_loss: 0.1446  time: 313s
Epoch 30 - Accuracy: 0.8761682242990654 - F1-score 0.8725286282231064
Number of bad epochs 9
Epoch 31 - avg_train_loss: 0.1376             avg_val_loss: 0.1539  time: 313s
Epoch 31 - Accuracy: 0.8677570093457944 - F1-score 0.8674334255709774
Number of bad epochs 10
Epoch 32 - avg_train_loss: 0.1363             avg_val_loss: 0.1692  time: 313s
Epoch 32 - Accuracy: 0.8558411214953271 - F1-score 0.8548450361452976
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 21: Best Accuracy: 0.8801 -                 Best F1-score: 0.8798
