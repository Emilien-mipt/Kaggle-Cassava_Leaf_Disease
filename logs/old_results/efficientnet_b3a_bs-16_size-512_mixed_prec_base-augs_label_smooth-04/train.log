Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.3634             avg_val_loss: 1.3401  time: 305s
Epoch 1 - Accuracy: 0.8322429906542056 - F1-score 0.8256772544539547
Epoch 1 - Save Best Accuracy: 0.8322 -                 Save Best F1-score: 0.8257 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.3409             avg_val_loss: 1.3300  time: 312s
Epoch 2 - Accuracy: 0.8514018691588785 - F1-score 0.8465616128678629
Epoch 2 - Save Best Accuracy: 0.8514 -                 Save Best F1-score: 0.8466 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 1.3337             avg_val_loss: 1.3203  time: 313s
Epoch 3 - Accuracy: 0.861214953271028 - F1-score 0.862520167428188
Epoch 3 - Save Best Accuracy: 0.8612 -                 Save Best F1-score: 0.8625 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 1.3288             avg_val_loss: 1.3187  time: 314s
Epoch 4 - Accuracy: 0.8630841121495327 - F1-score 0.8635752254948422
Epoch 4 - Save Best Accuracy: 0.8631 -                 Save Best F1-score: 0.8636 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 1.3263             avg_val_loss: 1.3186  time: 314s
Epoch 5 - Accuracy: 0.866588785046729 - F1-score 0.8664455369652323
Epoch 5 - Save Best Accuracy: 0.8666 -                 Save Best F1-score: 0.8664 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 1.3244             avg_val_loss: 1.3274  time: 314s
Epoch 6 - Accuracy: 0.8485981308411215 - F1-score 0.8517424721420301
Number of bad epochs 1
Epoch 7 - avg_train_loss: 1.3217             avg_val_loss: 1.3131  time: 314s
Epoch 7 - Accuracy: 0.8658878504672897 - F1-score 0.8674134920960076
Number of bad epochs 2
Epoch 8 - avg_train_loss: 1.3205             avg_val_loss: 1.3180  time: 314s
Epoch 8 - Accuracy: 0.8714953271028038 - F1-score 0.87233998369448
Epoch 8 - Save Best Accuracy: 0.8715 -                 Save Best F1-score: 0.8723 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 1.3201             avg_val_loss: 1.3116  time: 314s
Epoch 9 - Accuracy: 0.8745327102803738 - F1-score 0.8740627950754042
Epoch 9 - Save Best Accuracy: 0.8745 -                 Save Best F1-score: 0.8741 Model
Number of bad epochs 0
Epoch 10 - avg_train_loss: 1.3162             avg_val_loss: 1.3105  time: 314s
Epoch 10 - Accuracy: 0.8731308411214953 - F1-score 0.8705510667244162
Number of bad epochs 1
Epoch 11 - avg_train_loss: 1.3166             avg_val_loss: 1.3121  time: 314s
Epoch 11 - Accuracy: 0.8757009345794392 - F1-score 0.875663403337757
Epoch 11 - Save Best Accuracy: 0.8757 -                 Save Best F1-score: 0.8757 Model
Number of bad epochs 0
Epoch 12 - avg_train_loss: 1.3150             avg_val_loss: 1.3080  time: 309s
Epoch 12 - Accuracy: 0.8829439252336448 - F1-score 0.8804962010789477
Epoch 12 - Save Best Accuracy: 0.8829 -                 Save Best F1-score: 0.8805 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 1.3135             avg_val_loss: 1.3087  time: 308s
Epoch 13 - Accuracy: 0.874766355140187 - F1-score 0.8738198380144414
Number of bad epochs 1
Epoch 14 - avg_train_loss: 1.3132             avg_val_loss: 1.3170  time: 315s
Epoch 14 - Accuracy: 0.8768691588785047 - F1-score 0.878085405775988
Number of bad epochs 2
Epoch 15 - avg_train_loss: 1.3114             avg_val_loss: 1.3086  time: 314s
Epoch 15 - Accuracy: 0.877803738317757 - F1-score 0.8786982172555249
Number of bad epochs 3
Epoch 16 - avg_train_loss: 1.3110             avg_val_loss: 1.3116  time: 314s
Epoch 16 - Accuracy: 0.8738317757009346 - F1-score 0.8734039902326657
Number of bad epochs 4
Epoch 17 - avg_train_loss: 1.3120             avg_val_loss: 1.3111  time: 310s
Epoch 17 - Accuracy: 0.8782710280373832 - F1-score 0.8772695546207853
Number of bad epochs 5
Epoch 18 - avg_train_loss: 1.3100             avg_val_loss: 1.3055  time: 315s
Epoch 18 - Accuracy: 0.8792056074766356 - F1-score 0.8774341637203463
Number of bad epochs 6
Epoch 19 - avg_train_loss: 1.3094             avg_val_loss: 1.3129  time: 314s
Epoch 19 - Accuracy: 0.869392523364486 - F1-score 0.8713825308884569
Number of bad epochs 7
Epoch 20 - avg_train_loss: 1.3093             avg_val_loss: 1.3092  time: 314s
Epoch 20 - Accuracy: 0.8785046728971962 - F1-score 0.878140471357601
Number of bad epochs 8
Epoch 21 - avg_train_loss: 1.3088             avg_val_loss: 1.3031  time: 314s
Epoch 21 - Accuracy: 0.8892523364485981 - F1-score 0.8879914131804315
Epoch 21 - Save Best Accuracy: 0.8893 -                 Save Best F1-score: 0.8880 Model
Number of bad epochs 0
Epoch 22 - avg_train_loss: 1.3071             avg_val_loss: 1.3104  time: 314s
Epoch 22 - Accuracy: 0.8780373831775701 - F1-score 0.8771678279204358
Number of bad epochs 1
Epoch 23 - avg_train_loss: 1.3065             avg_val_loss: 1.3069  time: 314s
Epoch 23 - Accuracy: 0.8794392523364486 - F1-score 0.8794554280056136
Number of bad epochs 2
Epoch 24 - avg_train_loss: 1.3060             avg_val_loss: 1.3039  time: 314s
Epoch 24 - Accuracy: 0.8808411214953271 - F1-score 0.8803403052098433
Number of bad epochs 3
Epoch 25 - avg_train_loss: 1.3048             avg_val_loss: 1.3155  time: 314s
Epoch 25 - Accuracy: 0.8677570093457944 - F1-score 0.8681781848461446
Number of bad epochs 4
Epoch 26 - avg_train_loss: 1.3043             avg_val_loss: 1.3084  time: 314s
Epoch 26 - Accuracy: 0.8794392523364486 - F1-score 0.878490267038693
Number of bad epochs 5
Epoch 27 - avg_train_loss: 1.3047             avg_val_loss: 1.3062  time: 314s
Epoch 27 - Accuracy: 0.8810747663551401 - F1-score 0.8808778986724215
Number of bad epochs 6
Epoch 28 - avg_train_loss: 1.3042             avg_val_loss: 1.3077  time: 314s
Epoch 28 - Accuracy: 0.8768691588785047 - F1-score 0.8768240603455598
Number of bad epochs 7
Epoch 29 - avg_train_loss: 1.3024             avg_val_loss: 1.3121  time: 314s
Epoch 29 - Accuracy: 0.874766355140187 - F1-score 0.8745346651401722
Number of bad epochs 8
Epoch 30 - avg_train_loss: 1.3028             avg_val_loss: 1.3143  time: 314s
Epoch 30 - Accuracy: 0.8703271028037384 - F1-score 0.8701723756938791
Number of bad epochs 9
Epoch 31 - avg_train_loss: 1.3024             avg_val_loss: 1.3082  time: 314s
Epoch 31 - Accuracy: 0.8820093457943925 - F1-score 0.8806153210147438
Number of bad epochs 10
Epoch 32 - avg_train_loss: 1.3018             avg_val_loss: 1.3105  time: 314s
Epoch 32 - Accuracy: 0.875233644859813 - F1-score 0.8745504327098208
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 21: Best Accuracy: 0.8893 -                 Best F1-score: 0.8880
