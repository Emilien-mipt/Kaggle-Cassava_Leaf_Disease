Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.0692             avg_val_loss: 0.9965  time: 307s
Epoch 1 - Accuracy: 0.8457943925233645 - F1-score 0.8429877438445835
Epoch 1 - Save Best Accuracy: 0.8458 -                 Save Best F1-score: 0.8430 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.0192             avg_val_loss: 1.0143  time: 312s
Epoch 2 - Accuracy: 0.8355140186915888 - F1-score 0.8341537741392173
Number of bad epochs 1
Epoch 3 - avg_train_loss: 1.0045             avg_val_loss: 0.9757  time: 312s
Epoch 3 - Accuracy: 0.8637850467289719 - F1-score 0.8609122573441512
Epoch 3 - Save Best Accuracy: 0.8638 -                 Save Best F1-score: 0.8609 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.9955             avg_val_loss: 0.9957  time: 312s
Epoch 4 - Accuracy: 0.8523364485981308 - F1-score 0.8559639372188527
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.9889             avg_val_loss: 0.9894  time: 312s
Epoch 5 - Accuracy: 0.8616822429906542 - F1-score 0.8642581635350944
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.9874             avg_val_loss: 1.0146  time: 313s
Epoch 6 - Accuracy: 0.8376168224299065 - F1-score 0.8406807459174022
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.9799             avg_val_loss: 0.9694  time: 313s
Epoch 7 - Accuracy: 0.8656542056074766 - F1-score 0.8666006171830941
Epoch 7 - Save Best Accuracy: 0.8657 -                 Save Best F1-score: 0.8666 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 0.9766             avg_val_loss: 0.9793  time: 313s
Epoch 8 - Accuracy: 0.8689252336448599 - F1-score 0.8701918775324314
Epoch 8 - Save Best Accuracy: 0.8689 -                 Save Best F1-score: 0.8702 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 0.9755             avg_val_loss: 0.9680  time: 313s
Epoch 9 - Accuracy: 0.8703271028037384 - F1-score 0.8701833600011734
Number of bad epochs 1
Epoch 10 - avg_train_loss: 0.9679             avg_val_loss: 0.9746  time: 313s
Epoch 10 - Accuracy: 0.8691588785046729 - F1-score 0.8686250839233561
Number of bad epochs 2
Epoch 11 - avg_train_loss: 0.9674             avg_val_loss: 0.9626  time: 313s
Epoch 11 - Accuracy: 0.8768691588785047 - F1-score 0.8764408329070809
Epoch 11 - Save Best Accuracy: 0.8769 -                 Save Best F1-score: 0.8764 Model
Number of bad epochs 0
Epoch 12 - avg_train_loss: 0.9663             avg_val_loss: 0.9535  time: 313s
Epoch 12 - Accuracy: 0.8824766355140187 - F1-score 0.8803174737525478
Epoch 12 - Save Best Accuracy: 0.8825 -                 Save Best F1-score: 0.8803 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 0.9625             avg_val_loss: 0.9856  time: 313s
Epoch 13 - Accuracy: 0.8511682242990655 - F1-score 0.8525746081477665
Number of bad epochs 1
Epoch 14 - avg_train_loss: 0.9607             avg_val_loss: 0.9592  time: 313s
Epoch 14 - Accuracy: 0.8794392523364486 - F1-score 0.8798770200239568
Number of bad epochs 2
Epoch 15 - avg_train_loss: 0.9565             avg_val_loss: 0.9511  time: 313s
Epoch 15 - Accuracy: 0.883411214953271 - F1-score 0.884054512088953
Epoch 15 - Save Best Accuracy: 0.8834 -                 Save Best F1-score: 0.8841 Model
Number of bad epochs 0
Epoch 16 - avg_train_loss: 0.9583             avg_val_loss: 0.9590  time: 313s
Epoch 16 - Accuracy: 0.875 - F1-score 0.8738548474948106
Number of bad epochs 1
Epoch 17 - avg_train_loss: 0.9583             avg_val_loss: 0.9519  time: 313s
Epoch 17 - Accuracy: 0.8829439252336448 - F1-score 0.8822697156649636
Number of bad epochs 2
Epoch 18 - avg_train_loss: 0.9541             avg_val_loss: 0.9481  time: 312s
Epoch 18 - Accuracy: 0.8827102803738318 - F1-score 0.8823111524864704
Number of bad epochs 3
Epoch 19 - avg_train_loss: 0.9543             avg_val_loss: 0.9547  time: 313s
Epoch 19 - Accuracy: 0.8771028037383177 - F1-score 0.8780432382391428
Number of bad epochs 4
Epoch 20 - avg_train_loss: 0.9512             avg_val_loss: 0.9702  time: 313s
Epoch 20 - Accuracy: 0.8656542056074766 - F1-score 0.866902338779953
Number of bad epochs 5
Epoch 21 - avg_train_loss: 0.9516             avg_val_loss: 0.9394  time: 312s
Epoch 21 - Accuracy: 0.8862149532710281 - F1-score 0.8858575275180838
Epoch 21 - Save Best Accuracy: 0.8862 -                 Save Best F1-score: 0.8859 Model
Number of bad epochs 0
Epoch 22 - avg_train_loss: 0.9490             avg_val_loss: 0.9522  time: 307s
Epoch 22 - Accuracy: 0.8808411214953271 - F1-score 0.8809072266125623
Number of bad epochs 1
Epoch 23 - avg_train_loss: 0.9463             avg_val_loss: 0.9474  time: 312s
Epoch 23 - Accuracy: 0.8794392523364486 - F1-score 0.8777697635499179
Number of bad epochs 2
Epoch 24 - avg_train_loss: 0.9443             avg_val_loss: 0.9506  time: 313s
Epoch 24 - Accuracy: 0.883177570093458 - F1-score 0.8830467673163396
Number of bad epochs 3
Epoch 25 - avg_train_loss: 0.9424             avg_val_loss: 0.9543  time: 313s
Epoch 25 - Accuracy: 0.8785046728971962 - F1-score 0.8782859500295799
Number of bad epochs 4
Epoch 26 - avg_train_loss: 0.9407             avg_val_loss: 0.9503  time: 313s
Epoch 26 - Accuracy: 0.8803738317757009 - F1-score 0.8795084837276111
Number of bad epochs 5
Epoch 27 - avg_train_loss: 0.9409             avg_val_loss: 0.9547  time: 312s
Epoch 27 - Accuracy: 0.8775700934579439 - F1-score 0.8758603009417945
Number of bad epochs 6
Epoch 28 - avg_train_loss: 0.9415             avg_val_loss: 0.9657  time: 313s
Epoch 28 - Accuracy: 0.8703271028037384 - F1-score 0.8699679622018843
Number of bad epochs 7
Epoch 29 - avg_train_loss: 0.9374             avg_val_loss: 0.9521  time: 313s
Epoch 29 - Accuracy: 0.8799065420560748 - F1-score 0.876931165508699
Number of bad epochs 8
Epoch 30 - avg_train_loss: 0.9374             avg_val_loss: 0.9534  time: 313s
Epoch 30 - Accuracy: 0.875233644859813 - F1-score 0.8728111896089389
Number of bad epochs 9
Epoch 31 - avg_train_loss: 0.9365             avg_val_loss: 0.9548  time: 313s
Epoch 31 - Accuracy: 0.8780373831775701 - F1-score 0.8778342934297427
Number of bad epochs 10
Epoch 32 - avg_train_loss: 0.9353             avg_val_loss: 0.9546  time: 313s
Epoch 32 - Accuracy: 0.8703271028037384 - F1-score 0.8703633217153122
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 21: Best Accuracy: 0.8862 -                 Best F1-score: 0.8859
