Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.5260             avg_val_loss: 0.5083  time: 303s
Epoch 1 - Accuracy: 0.8329439252336449 - F1-score 0.8330701168579814
Epoch 1 - Save Best Accuracy: 0.8329 -                 Save Best F1-score: 0.8331 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.4281             avg_val_loss: 0.3953  time: 311s
Epoch 2 - Accuracy: 0.8682242990654205 - F1-score 0.8690080875216333
Epoch 2 - Save Best Accuracy: 0.8682 -                 Save Best F1-score: 0.8690 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.3973             avg_val_loss: 0.3935  time: 312s
Epoch 3 - Accuracy: 0.8710280373831776 - F1-score 0.870484486541043
Epoch 3 - Save Best Accuracy: 0.8710 -                 Save Best F1-score: 0.8705 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.3758             avg_val_loss: 0.4540  time: 312s
Epoch 4 - Accuracy: 0.8420560747663551 - F1-score 0.8437091427963498
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.3648             avg_val_loss: 0.3775  time: 312s
Epoch 5 - Accuracy: 0.8710280373831776 - F1-score 0.8728587565447629
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.3467             avg_val_loss: 0.3905  time: 312s
Epoch 6 - Accuracy: 0.8726635514018691 - F1-score 0.8720854961050523
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.3418             avg_val_loss: 0.3978  time: 313s
Epoch 7 - Accuracy: 0.8691588785046729 - F1-score 0.8692618632240623
Number of bad epochs 4
Epoch 8 - avg_train_loss: 0.3304             avg_val_loss: 0.4399  time: 313s
Epoch 8 - Accuracy: 0.8696261682242991 - F1-score 0.868031596566923
Number of bad epochs 5
Epoch 9 - avg_train_loss: 0.3167             avg_val_loss: 0.3908  time: 313s
Epoch 9 - Accuracy: 0.8651869158878505 - F1-score 0.8647700770344516
Number of bad epochs 6
Epoch 10 - avg_train_loss: 0.3040             avg_val_loss: 0.4016  time: 312s
Epoch 10 - Accuracy: 0.8703271028037384 - F1-score 0.8686965784780659
Number of bad epochs 7
Epoch 11 - avg_train_loss: 0.2984             avg_val_loss: 0.4679  time: 312s
Epoch 11 - Accuracy: 0.8649532710280374 - F1-score 0.8633715186656684
Number of bad epochs 8
Epoch 12 - avg_train_loss: 0.2839             avg_val_loss: 0.4111  time: 313s
Epoch 12 - Accuracy: 0.8745327102803738 - F1-score 0.8713398930290623
Number of bad epochs 9
Epoch 13 - avg_train_loss: 0.2747             avg_val_loss: 0.3830  time: 312s
Epoch 13 - Accuracy: 0.875233644859813 - F1-score 0.8755142969019147
Epoch 13 - Save Best Accuracy: 0.8752 -                 Save Best F1-score: 0.8755 Model
Number of bad epochs 0
Epoch 14 - avg_train_loss: 0.2647             avg_val_loss: 0.4155  time: 312s
Epoch 14 - Accuracy: 0.8726635514018691 - F1-score 0.8733853197677299
Number of bad epochs 1
Epoch 15 - avg_train_loss: 0.2577             avg_val_loss: 0.4112  time: 312s
Epoch 15 - Accuracy: 0.8733644859813084 - F1-score 0.8722723769701951
Number of bad epochs 2
Epoch 16 - avg_train_loss: 0.2480             avg_val_loss: 0.4228  time: 312s
Epoch 16 - Accuracy: 0.8698598130841122 - F1-score 0.867714785776139
Number of bad epochs 3
Epoch 17 - avg_train_loss: 0.2412             avg_val_loss: 0.4123  time: 312s
Epoch 17 - Accuracy: 0.8686915887850467 - F1-score 0.8669943085817194
Number of bad epochs 4
Epoch 18 - avg_train_loss: 0.2267             avg_val_loss: 0.4125  time: 312s
Epoch 18 - Accuracy: 0.875 - F1-score 0.8736026690946636
Number of bad epochs 5
Epoch 19 - avg_train_loss: 0.2210             avg_val_loss: 0.4471  time: 312s
Epoch 19 - Accuracy: 0.8682242990654205 - F1-score 0.8679469933429316
Number of bad epochs 6
Epoch 20 - avg_train_loss: 0.2148             avg_val_loss: 0.4325  time: 312s
Epoch 20 - Accuracy: 0.8707943925233644 - F1-score 0.8708545823099452
Number of bad epochs 7
Epoch 21 - avg_train_loss: 0.2059             avg_val_loss: 0.4305  time: 312s
Epoch 21 - Accuracy: 0.8649532710280374 - F1-score 0.8659737206412539
Number of bad epochs 8
Epoch 22 - avg_train_loss: 0.1948             avg_val_loss: 0.4974  time: 312s
Epoch 22 - Accuracy: 0.8474299065420561 - F1-score 0.8514998290177032
Number of bad epochs 9
Epoch 23 - avg_train_loss: 0.1874             avg_val_loss: 0.4889  time: 312s
Epoch 23 - Accuracy: 0.8670560747663552 - F1-score 0.8660024435894109
Number of bad epochs 10
Epoch 24 - avg_train_loss: 0.1744             avg_val_loss: 0.4803  time: 312s
Epoch 24 - Accuracy: 0.8635514018691589 - F1-score 0.8642044664113189
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 13: Best Accuracy: 0.8752 -                 Best F1-score: 0.8755
