Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name vit_base_patch16_224
Batch size 16
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.1721             avg_val_loss: 1.1003  time: 269s
Epoch 1 - Accuracy: 0.6205607476635514 - F1-score 0.4842324272047244
Epoch 1 - Save Best Accuracy: 0.6206 -                 Save Best F1-score: 0.4842 Model
Epoch 2 - avg_train_loss: 1.0349             avg_val_loss: 1.0115  time: 263s
Epoch 2 - Accuracy: 0.633177570093458 - F1-score 0.519969725750901
Epoch 2 - Save Best Accuracy: 0.6332 -                 Save Best F1-score: 0.5200 Model
Epoch 3 - avg_train_loss: 0.9687             avg_val_loss: 0.9441  time: 276s
Epoch 3 - Accuracy: 0.6595794392523364 - F1-score 0.5771634032153262
Epoch 3 - Save Best Accuracy: 0.6596 -                 Save Best F1-score: 0.5772 Model
Epoch 4 - avg_train_loss: 0.9219             avg_val_loss: 0.9495  time: 252s
Epoch 4 - Accuracy: 0.6490654205607477 - F1-score 0.5664788409617535
Epoch 5 - avg_train_loss: 0.8930             avg_val_loss: 0.9450  time: 276s
Epoch 5 - Accuracy: 0.6602803738317757 - F1-score 0.5992044061954124
Epoch 5 - Save Best Accuracy: 0.6603 -                 Save Best F1-score: 0.5992 Model
Epoch 6 - avg_train_loss: 0.8636             avg_val_loss: 0.9257  time: 265s
Epoch 6 - Accuracy: 0.6677570093457944 - F1-score 0.6078100401698268
Epoch 6 - Save Best Accuracy: 0.6678 -                 Save Best F1-score: 0.6078 Model
Epoch 7 - avg_train_loss: 0.8317             avg_val_loss: 0.9331  time: 269s
Epoch 7 - Accuracy: 0.6572429906542057 - F1-score 0.5920296802019137
Epoch 8 - avg_train_loss: 0.8467             avg_val_loss: 0.9253  time: 275s
Epoch 8 - Accuracy: 0.664018691588785 - F1-score 0.5994530095777436
Epoch 9 - avg_train_loss: 0.7953             avg_val_loss: 0.9191  time: 256s
Epoch 9 - Accuracy: 0.6672897196261682 - F1-score 0.6289851256058316
Epoch 10 - avg_train_loss: 0.7631             avg_val_loss: 0.9125  time: 274s
Epoch 10 - Accuracy: 0.6700934579439253 - F1-score 0.6358260616035935
Epoch 10 - Save Best Accuracy: 0.6701 -                 Save Best F1-score: 0.6358 Model
Epoch 11 - avg_train_loss: 0.7289             avg_val_loss: 0.9161  time: 258s
Epoch 11 - Accuracy: 0.6661214953271029 - F1-score 0.6374095562587884
Epoch 12 - avg_train_loss: 0.7122             avg_val_loss: 0.9703  time: 274s
Epoch 12 - Accuracy: 0.6679906542056074 - F1-score 0.6030009435103393
Epoch 13 - avg_train_loss: 0.6811             avg_val_loss: 0.9264  time: 269s
Epoch 13 - Accuracy: 0.6647196261682243 - F1-score 0.6324692656220828
Epoch 14 - avg_train_loss: 0.6557             avg_val_loss: 0.9689  time: 259s
Epoch 14 - Accuracy: 0.6719626168224299 - F1-score 0.6326543060997274
Epoch 15 - avg_train_loss: 0.6243             avg_val_loss: 0.9492  time: 273s
Epoch 15 - Accuracy: 0.6574766355140187 - F1-score 0.6436779053202141
Epoch 16 - avg_train_loss: 0.6048             avg_val_loss: 0.9692  time: 254s
Epoch 16 - Accuracy: 0.652803738317757 - F1-score 0.6349336468824521
Epoch 17 - avg_train_loss: 0.5775             avg_val_loss: 1.0520  time: 273s
Epoch 17 - Accuracy: 0.6607476635514019 - F1-score 0.6422061817756803
Epoch 18 - avg_train_loss: 0.5588             avg_val_loss: 1.0199  time: 270s
Epoch 18 - Accuracy: 0.6420560747663552 - F1-score 0.6371257000949828
Epoch 19 - avg_train_loss: 0.5303             avg_val_loss: 1.0083  time: 260s
Epoch 19 - Accuracy: 0.6532710280373831 - F1-score 0.6460270594867134
Epoch 20 - avg_train_loss: 0.5052             avg_val_loss: 1.1648  time: 273s
Epoch 20 - Accuracy: 0.6240654205607477 - F1-score 0.6255585192163984
Epoch 21 - avg_train_loss: 0.5004             avg_val_loss: 1.0640  time: 253s
Epoch 21 - Accuracy: 0.6488317757009345 - F1-score 0.6464502922019164
Epoch 22 - avg_train_loss: 0.4742             avg_val_loss: 1.1908  time: 274s
Epoch 22 - Accuracy: 0.6362149532710281 - F1-score 0.631817049646161
Epoch 23 - avg_train_loss: 0.4443             avg_val_loss: 1.2613  time: 268s
Epoch 23 - Accuracy: 0.6492990654205607 - F1-score 0.6322555598945533
Epoch 24 - avg_train_loss: 0.4195             avg_val_loss: 1.2396  time: 259s
Epoch 24 - Accuracy: 0.6264018691588785 - F1-score 0.6342044821211221
Epoch 25 - avg_train_loss: 0.4044             avg_val_loss: 1.2708  time: 275s
Epoch 25 - Accuracy: 0.6542056074766355 - F1-score 0.6390211818709489
Epoch 26 - avg_train_loss: 0.3888             avg_val_loss: 1.3249  time: 252s
Epoch 26 - Accuracy: 0.6434579439252337 - F1-score 0.6334713036534894
Epoch 27 - avg_train_loss: 0.3767             avg_val_loss: 1.2748  time: 275s
Epoch 27 - Accuracy: 0.6224299065420561 - F1-score 0.6330661819254991
Epoch 28 - avg_train_loss: 0.3586             avg_val_loss: 1.3010  time: 268s
Epoch 28 - Accuracy: 0.6457943925233645 - F1-score 0.6358321884040532
Epoch 29 - avg_train_loss: 0.3456             avg_val_loss: 1.4017  time: 262s
Epoch 29 - Accuracy: 0.6558411214953271 - F1-score 0.6293788362455233
Epoch 30 - avg_train_loss: 0.3182             avg_val_loss: 1.3691  time: 273s
Epoch 30 - Accuracy: 0.6623831775700935 - F1-score 0.6318651675407134
Epoch 31 - avg_train_loss: 0.3077             avg_val_loss: 1.4881  time: 252s
Epoch 31 - Accuracy: 0.6642523364485982 - F1-score 0.6409524300053311
Epoch 32 - avg_train_loss: 0.2843             avg_val_loss: 1.5651  time: 272s
Epoch 32 - Accuracy: 0.6140186915887851 - F1-score 0.6184570929227171
Epoch 33 - avg_train_loss: 0.2723             avg_val_loss: 1.7011  time: 267s
Epoch 33 - Accuracy: 0.6413551401869159 - F1-score 0.6259077688797016
Epoch 34 - avg_train_loss: 0.2603             avg_val_loss: 1.5679  time: 263s
Epoch 34 - Accuracy: 0.6299065420560748 - F1-score 0.6267806006181375
Epoch 35 - avg_train_loss: 0.2477             avg_val_loss: 1.6139  time: 275s
Epoch 35 - Accuracy: 0.6200934579439252 - F1-score 0.6196357503012271
Epoch 36 - avg_train_loss: 0.2369             avg_val_loss: 1.7396  time: 256s
Epoch 36 - Accuracy: 0.6455607476635514 - F1-score 0.6341987345038741
Epoch 37 - avg_train_loss: 0.2405             avg_val_loss: 1.6568  time: 276s
Epoch 37 - Accuracy: 0.6352803738317757 - F1-score 0.6281414655963583
Epoch 38 - avg_train_loss: 0.2218             avg_val_loss: 1.6600  time: 262s
Epoch 38 - Accuracy: 0.6383177570093458 - F1-score 0.6293016022428151
Epoch 39 - avg_train_loss: 0.2148             avg_val_loss: 1.8820  time: 269s
Epoch 39 - Accuracy: 0.6441588785046729 - F1-score 0.6212816124547242
Epoch 40 - avg_train_loss: 0.1978             avg_val_loss: 1.8338  time: 275s
Epoch 40 - Accuracy: 0.6341121495327103 - F1-score 0.6146150005527267
Epoch 41 - avg_train_loss: 0.1931             avg_val_loss: 1.6168  time: 256s
Epoch 41 - Accuracy: 0.6128504672897196 - F1-score 0.6181473045358813
Epoch 42 - avg_train_loss: 0.1776             avg_val_loss: 1.8760  time: 275s
Epoch 42 - Accuracy: 0.6207943925233644 - F1-score 0.6222379602085015
Epoch 43 - avg_train_loss: 0.1912             avg_val_loss: 1.9201  time: 257s
Epoch 43 - Accuracy: 0.608411214953271 - F1-score 0.613166766819071
Epoch 44 - avg_train_loss: 0.1592             avg_val_loss: 1.8820  time: 273s
Epoch 44 - Accuracy: 0.6184579439252337 - F1-score 0.6230087537243046
Epoch 45 - avg_train_loss: 0.1637             avg_val_loss: 1.6640  time: 269s
Epoch 45 - Accuracy: 0.6511682242990654 - F1-score 0.6341974883594048
Epoch 46 - avg_train_loss: 0.1567             avg_val_loss: 1.8688  time: 261s
Epoch 46 - Accuracy: 0.6219626168224299 - F1-score 0.6242348526458494
Epoch 47 - avg_train_loss: 0.1551             avg_val_loss: 1.9714  time: 273s
Epoch 47 - Accuracy: 0.6266355140186916 - F1-score 0.6245777844941641
Epoch 48 - avg_train_loss: 0.1494             avg_val_loss: 2.0624  time: 253s
Epoch 48 - Accuracy: 0.6301401869158878 - F1-score 0.6254758823412212
Epoch 49 - avg_train_loss: 0.1462             avg_val_loss: 2.0846  time: 272s
Epoch 49 - Accuracy: 0.6453271028037383 - F1-score 0.626961547255567
Epoch 50 - avg_train_loss: 0.1437             avg_val_loss: 1.8605  time: 267s
Epoch 50 - Accuracy: 0.6147196261682243 - F1-score 0.6206594688655758
AFTER TRAINING: Best Accuracy: 0.6720 -                 Best F1-score: 0.6465
