Reading data...
Weight list for classes: [1.         0.49657378 0.45557418 0.08261134 0.4218083 ]
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.5998             avg_val_loss: 0.4690  time: 312s
Epoch 1 - Accuracy: 0.8411214953271028 - F1-score 0.8350341398482913
Epoch 1 - Save Best Accuracy: 0.8411 -                 Save Best F1-score: 0.8350 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.4980             avg_val_loss: 0.4939  time: 316s
Epoch 2 - Accuracy: 0.8280373831775701 - F1-score 0.8271576139577695
Number of bad epochs 1
Epoch 3 - avg_train_loss: 0.4719             avg_val_loss: 0.3941  time: 316s
Epoch 3 - Accuracy: 0.8728971962616823 - F1-score 0.870222048827009
Epoch 3 - Save Best Accuracy: 0.8729 -                 Save Best F1-score: 0.8702 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.4490             avg_val_loss: 0.4811  time: 316s
Epoch 4 - Accuracy: 0.8380841121495327 - F1-score 0.8430223933300156
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.4444             avg_val_loss: 0.4090  time: 316s
Epoch 5 - Accuracy: 0.8698598130841122 - F1-score 0.8669368334774098
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.4338             avg_val_loss: 0.4194  time: 316s
Epoch 6 - Accuracy: 0.8656542056074766 - F1-score 0.8577476433506296
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.4266             avg_val_loss: 0.4000  time: 316s
Epoch 7 - Accuracy: 0.8616822429906542 - F1-score 0.8631831790070231
Number of bad epochs 4
Epoch 8 - avg_train_loss: 0.4141             avg_val_loss: 0.3772  time: 316s
Epoch 8 - Accuracy: 0.8726635514018691 - F1-score 0.873638962322358
Number of bad epochs 5
Epoch 9 - avg_train_loss: 0.4066             avg_val_loss: 0.3808  time: 315s
Epoch 9 - Accuracy: 0.8735981308411215 - F1-score 0.8735596585884724
Number of bad epochs 6
Epoch 10 - avg_train_loss: 0.4026             avg_val_loss: 0.3667  time: 315s
Epoch 10 - Accuracy: 0.8757009345794392 - F1-score 0.8755145229346104
Epoch 10 - Save Best Accuracy: 0.8757 -                 Save Best F1-score: 0.8755 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 0.3947             avg_val_loss: 0.3835  time: 316s
Epoch 11 - Accuracy: 0.8761682242990654 - F1-score 0.8725990623230465
Number of bad epochs 1
Epoch 12 - avg_train_loss: 0.3923             avg_val_loss: 0.3856  time: 316s
Epoch 12 - Accuracy: 0.8759345794392523 - F1-score 0.8723167591543249
Number of bad epochs 2
Epoch 13 - avg_train_loss: 0.3796             avg_val_loss: 0.3895  time: 316s
Epoch 13 - Accuracy: 0.8684579439252337 - F1-score 0.8678983592499966
Number of bad epochs 3
Epoch 14 - avg_train_loss: 0.3878             avg_val_loss: 0.3796  time: 316s
Epoch 14 - Accuracy: 0.8731308411214953 - F1-score 0.8747112963923281
Number of bad epochs 4
Epoch 15 - avg_train_loss: 0.3743             avg_val_loss: 0.3797  time: 316s
Epoch 15 - Accuracy: 0.8703271028037384 - F1-score 0.8713664209721272
Number of bad epochs 5
Epoch 16 - avg_train_loss: 0.3708             avg_val_loss: 0.3864  time: 315s
Epoch 16 - Accuracy: 0.8731308411214953 - F1-score 0.8688319133905076
Number of bad epochs 6
Epoch 17 - avg_train_loss: 0.3702             avg_val_loss: 0.3721  time: 315s
Epoch 17 - Accuracy: 0.8764018691588785 - F1-score 0.8766144690851221
Epoch 17 - Save Best Accuracy: 0.8764 -                 Save Best F1-score: 0.8766 Model
Number of bad epochs 0
Epoch 18 - avg_train_loss: 0.3633             avg_val_loss: 0.3659  time: 315s
Epoch 18 - Accuracy: 0.8796728971962616 - F1-score 0.879063864228055
Epoch 18 - Save Best Accuracy: 0.8797 -                 Save Best F1-score: 0.8791 Model
Number of bad epochs 0
Epoch 19 - avg_train_loss: 0.3579             avg_val_loss: 0.3755  time: 316s
Epoch 19 - Accuracy: 0.8799065420560748 - F1-score 0.8771728654933227
Number of bad epochs 1
Epoch 20 - avg_train_loss: 0.3521             avg_val_loss: 0.3685  time: 315s
Epoch 20 - Accuracy: 0.8771028037383177 - F1-score 0.877619270094576
Number of bad epochs 2
Epoch 21 - avg_train_loss: 0.3515             avg_val_loss: 0.4182  time: 316s
Epoch 21 - Accuracy: 0.8579439252336448 - F1-score 0.861344714410042
Number of bad epochs 3
Epoch 22 - avg_train_loss: 0.3470             avg_val_loss: 0.3720  time: 316s
Epoch 22 - Accuracy: 0.8794392523364486 - F1-score 0.8786968211998671
Number of bad epochs 4
Epoch 23 - avg_train_loss: 0.3490             avg_val_loss: 0.3904  time: 315s
Epoch 23 - Accuracy: 0.8768691588785047 - F1-score 0.8740358405832467
Number of bad epochs 5
Epoch 24 - avg_train_loss: 0.3463             avg_val_loss: 0.3595  time: 315s
Epoch 24 - Accuracy: 0.8803738317757009 - F1-score 0.880360397816121
Epoch 24 - Save Best Accuracy: 0.8804 -                 Save Best F1-score: 0.8804 Model
Number of bad epochs 0
Epoch 25 - avg_train_loss: 0.3411             avg_val_loss: 0.3734  time: 315s
Epoch 25 - Accuracy: 0.8803738317757009 - F1-score 0.8785546103444424
Number of bad epochs 1
Epoch 26 - avg_train_loss: 0.3342             avg_val_loss: 0.3921  time: 315s
Epoch 26 - Accuracy: 0.8719626168224299 - F1-score 0.8723206263009613
Number of bad epochs 2
Epoch 27 - avg_train_loss: 0.3344             avg_val_loss: 0.4199  time: 315s
Epoch 27 - Accuracy: 0.860981308411215 - F1-score 0.855544040316726
Number of bad epochs 3
Epoch 28 - avg_train_loss: 0.3277             avg_val_loss: 0.3945  time: 315s
Epoch 28 - Accuracy: 0.8733644859813084 - F1-score 0.8726166349096889
Number of bad epochs 4
