Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Current learning rate: 0.0505
Epoch 1 - avg_train_loss: 1.3753             avg_val_loss: 1.3352  time: 305s
Epoch 1 - Accuracy: 0.8553738317757009 - F1-score 0.8560731854576517
Epoch 1 - Save Best Accuracy: 0.8554 -                 Save Best F1-score: 0.8561 Model
Number of bad epochs 0
Current learning rate: 0.1
Epoch 2 - avg_train_loss: 1.3347             avg_val_loss: 1.3216  time: 308s
Epoch 2 - Accuracy: 0.8724299065420561 - F1-score 0.8707707573801096
Epoch 2 - Save Best Accuracy: 0.8724 -                 Save Best F1-score: 0.8708 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 3 - avg_train_loss: 1.3230             avg_val_loss: 1.3110  time: 308s
Epoch 3 - Accuracy: 0.8836448598130842 - F1-score 0.8809693900010922
Epoch 3 - Save Best Accuracy: 0.8836 -                 Save Best F1-score: 0.8810 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 1.3095             avg_val_loss: 1.3017  time: 308s
Epoch 4 - Accuracy: 0.8876168224299066 - F1-score 0.8856730526684304
Epoch 4 - Save Best Accuracy: 0.8876 -                 Save Best F1-score: 0.8857 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 5 - avg_train_loss: 1.3035             avg_val_loss: 1.3033  time: 308s
Epoch 5 - Accuracy: 0.8941588785046729 - F1-score 0.8929791669622215
Epoch 5 - Save Best Accuracy: 0.8942 -                 Save Best F1-score: 0.8930 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 6 - avg_train_loss: 1.3083             avg_val_loss: 1.3108  time: 308s
Epoch 6 - Accuracy: 0.8787383177570094 - F1-score 0.8787833711709833
Number of bad epochs 1
Current learning rate: 0.025750000000000002
Epoch 7 - avg_train_loss: 1.3061             avg_val_loss: 1.3038  time: 308s
Epoch 7 - Accuracy: 0.8869158878504673 - F1-score 0.8857628704510914
Number of bad epochs 2
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 1.2988             avg_val_loss: 1.3010  time: 307s
Epoch 8 - Accuracy: 0.8934579439252337 - F1-score 0.8929122911728292
Number of bad epochs 3
Current learning rate: 0.013375000000000001
Epoch 9 - avg_train_loss: 1.2946             avg_val_loss: 1.3003  time: 308s
Epoch 9 - Accuracy: 0.8929906542056075 - F1-score 0.8925894193181909
Number of bad epochs 4
Current learning rate: 0.025750000000000002
Epoch 10 - avg_train_loss: 1.2957             avg_val_loss: 1.3035  time: 308s
Epoch 10 - Accuracy: 0.8913551401869159 - F1-score 0.8899950503261397
Number of bad epochs 5
Current learning rate: 0.013375000000000001
Epoch 11 - avg_train_loss: 1.2956             avg_val_loss: 1.3020  time: 308s
Epoch 11 - Accuracy: 0.8901869158878505 - F1-score 0.8889625257842383
Number of bad epochs 6
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 1.2911             avg_val_loss: 1.3000  time: 308s
Epoch 12 - Accuracy: 0.8946261682242991 - F1-score 0.894104131015469
Epoch 12 - Save Best Accuracy: 0.8946 -                 Save Best F1-score: 0.8941 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 13 - avg_train_loss: 1.2887             avg_val_loss: 1.3015  time: 308s
Epoch 13 - Accuracy: 0.8911214953271028 - F1-score 0.8899463254616755
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 14 - avg_train_loss: 1.2892             avg_val_loss: 1.3007  time: 308s
Epoch 14 - Accuracy: 0.8941588785046729 - F1-score 0.8938980070213594
Number of bad epochs 2
Current learning rate: 0.0071875
Epoch 15 - avg_train_loss: 1.2891             avg_val_loss: 1.3016  time: 308s
Epoch 15 - Accuracy: 0.8920560747663552 - F1-score 0.8914216084996981
Number of bad epochs 3
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 1.2854             avg_val_loss: 1.3014  time: 308s
Epoch 16 - Accuracy: 0.8913551401869159 - F1-score 0.8906050322803797
Number of bad epochs 4
Current learning rate: 0.00409375
Epoch 17 - avg_train_loss: 1.2856             avg_val_loss: 1.2999  time: 308s
Epoch 17 - Accuracy: 0.8946261682242991 - F1-score 0.8942117714234287
Epoch 17 - Save Best Accuracy: 0.8946 -                 Save Best F1-score: 0.8942 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 18 - avg_train_loss: 1.2851             avg_val_loss: 1.3010  time: 308s
Epoch 18 - Accuracy: 0.8950934579439253 - F1-score 0.8942110198727682
Number of bad epochs 1
Current learning rate: 0.00409375
Epoch 19 - avg_train_loss: 1.2856             avg_val_loss: 1.3019  time: 308s
Epoch 19 - Accuracy: 0.8901869158878505 - F1-score 0.888958526760839
Number of bad epochs 2
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 1.2827             avg_val_loss: 1.3014  time: 308s
Epoch 20 - Accuracy: 0.8920560747663552 - F1-score 0.8918918098947272
Number of bad epochs 3
Current learning rate: 0.002546875
Epoch 21 - avg_train_loss: 1.2825             avg_val_loss: 1.3026  time: 307s
Epoch 21 - Accuracy: 0.8906542056074767 - F1-score 0.8901535713258666
Number of bad epochs 4
Current learning rate: 0.00409375
Epoch 22 - avg_train_loss: 1.2828             avg_val_loss: 1.3036  time: 308s
Epoch 22 - Accuracy: 0.889018691588785 - F1-score 0.8882734961790556
Number of bad epochs 5
Current learning rate: 0.002546875
Epoch 23 - avg_train_loss: 1.2819             avg_val_loss: 1.3014  time: 308s
Epoch 23 - Accuracy: 0.8934579439252337 - F1-score 0.8925621993185455
Number of bad epochs 6
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 1.2818             avg_val_loss: 1.3021  time: 308s
Epoch 24 - Accuracy: 0.891588785046729 - F1-score 0.8908144671492231
Number of bad epochs 7
Current learning rate: 0.0017734375
Epoch 25 - avg_train_loss: 1.2816             avg_val_loss: 1.3025  time: 308s
Epoch 25 - Accuracy: 0.8901869158878505 - F1-score 0.8895727496567206
Number of bad epochs 8
Current learning rate: 0.002546875
Epoch 26 - avg_train_loss: 1.2800             avg_val_loss: 1.3017  time: 308s
Epoch 26 - Accuracy: 0.891588785046729 - F1-score 0.8907228751743202
Number of bad epochs 9
Current learning rate: 0.0017734375
Epoch 27 - avg_train_loss: 1.2801             avg_val_loss: 1.3022  time: 308s
Epoch 27 - Accuracy: 0.8911214953271028 - F1-score 0.8902493887413548
Number of bad epochs 10
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 1.2803             avg_val_loss: 1.3013  time: 308s
Epoch 28 - Accuracy: 0.8946261682242991 - F1-score 0.8938280394748597
Number of bad epochs 11
Current learning rate: 0.00138671875
Epoch 29 - avg_train_loss: 1.2798             avg_val_loss: 1.3023  time: 308s
Epoch 29 - Accuracy: 0.8904205607476635 - F1-score 0.8898875571971637
Number of bad epochs 12
Current learning rate: 0.0017734375
Epoch 30 - avg_train_loss: 1.2798             avg_val_loss: 1.3024  time: 308s
Epoch 30 - Accuracy: 0.8911214953271028 - F1-score 0.8903657148307367
Number of bad epochs 13
Current learning rate: 0.00138671875
Epoch 31 - avg_train_loss: 1.2796             avg_val_loss: 1.3022  time: 308s
Epoch 31 - Accuracy: 0.8932242990654206 - F1-score 0.8926258624278052
Number of bad epochs 14
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 1.2804             avg_val_loss: 1.3028  time: 308s
Epoch 32 - Accuracy: 0.888785046728972 - F1-score 0.8877944483684341
Number of bad epochs 15
Current learning rate: 0.001193359375
Epoch 33 - avg_train_loss: 1.2784             avg_val_loss: 1.3023  time: 309s
Epoch 33 - Accuracy: 0.8925233644859814 - F1-score 0.8918558276120114
Number of bad epochs 16
Current learning rate: 0.00138671875
Epoch 34 - avg_train_loss: 1.2791             avg_val_loss: 1.3024  time: 309s
Epoch 34 - Accuracy: 0.8929906542056075 - F1-score 0.8918539721606609
Number of bad epochs 17
Current learning rate: 0.001193359375
Epoch 35 - avg_train_loss: 1.2784             avg_val_loss: 1.3023  time: 308s
Epoch 35 - Accuracy: 0.8920560747663552 - F1-score 0.8909539259688602
Number of bad epochs 18
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 1.2779             avg_val_loss: 1.3036  time: 308s
Epoch 36 - Accuracy: 0.8906542056074767 - F1-score 0.8900774311819075
Number of bad epochs 19
Current learning rate: 0.0010966796875
Epoch 37 - avg_train_loss: 1.2784             avg_val_loss: 1.3033  time: 308s
Epoch 37 - Accuracy: 0.8906542056074767 - F1-score 0.8902006195445215
Number of bad epochs 20
Current learning rate: 0.001193359375
Epoch 38 - avg_train_loss: 1.2781             avg_val_loss: 1.3026  time: 308s
Epoch 38 - Accuracy: 0.8906542056074767 - F1-score 0.8892493348943223
Number of bad epochs 21
Stop the training, since the score has not improved for 20 epochs!
AFTER TRAINING: Epoch 17: Best Accuracy: 0.8951 -                 Best F1-score: 0.8942
