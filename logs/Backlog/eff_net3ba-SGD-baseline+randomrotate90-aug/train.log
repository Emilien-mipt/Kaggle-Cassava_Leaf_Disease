Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Current learning rate: 0.0505
Epoch 1 - avg_train_loss: 1.3731             avg_val_loss: 1.3396  time: 292s
Epoch 1 - Accuracy: 0.8558411214953271 - F1-score 0.8548090510735
Epoch 1 - Save Best Accuracy: 0.8558 -                 Save Best F1-score: 0.8548 Model
Number of bad epochs 0
Current learning rate: 0.1
Epoch 2 - avg_train_loss: 1.3342             avg_val_loss: 1.3189  time: 300s
Epoch 2 - Accuracy: 0.8733644859813084 - F1-score 0.8708932767236557
Epoch 2 - Save Best Accuracy: 0.8734 -                 Save Best F1-score: 0.8709 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 3 - avg_train_loss: 1.3230             avg_val_loss: 1.3130  time: 301s
Epoch 3 - Accuracy: 0.8801401869158878 - F1-score 0.877023427992749
Epoch 3 - Save Best Accuracy: 0.8801 -                 Save Best F1-score: 0.8770 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 1.3096             avg_val_loss: 1.3007  time: 302s
Epoch 4 - Accuracy: 0.8911214953271028 - F1-score 0.8896866061060245
Epoch 4 - Save Best Accuracy: 0.8911 -                 Save Best F1-score: 0.8897 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 5 - avg_train_loss: 1.3029             avg_val_loss: 1.3021  time: 302s
Epoch 5 - Accuracy: 0.8866822429906542 - F1-score 0.8852475833380626
Number of bad epochs 1
Current learning rate: 0.0505
Epoch 6 - avg_train_loss: 1.3075             avg_val_loss: 1.3166  time: 302s
Epoch 6 - Accuracy: 0.8735981308411215 - F1-score 0.8752791322306668
Number of bad epochs 2
Current learning rate: 0.025750000000000002
Epoch 7 - avg_train_loss: 1.3055             avg_val_loss: 1.3051  time: 302s
Epoch 7 - Accuracy: 0.8873831775700934 - F1-score 0.8857814956165396
Number of bad epochs 3
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 1.2980             avg_val_loss: 1.3007  time: 302s
Epoch 8 - Accuracy: 0.8899532710280373 - F1-score 0.8893105228914137
Number of bad epochs 4
Current learning rate: 0.013375000000000001
Epoch 9 - avg_train_loss: 1.2940             avg_val_loss: 1.3019  time: 302s
Epoch 9 - Accuracy: 0.8922897196261682 - F1-score 0.8917183995511607
Epoch 9 - Save Best Accuracy: 0.8923 -                 Save Best F1-score: 0.8917 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 10 - avg_train_loss: 1.2963             avg_val_loss: 1.3042  time: 302s
Epoch 10 - Accuracy: 0.8855140186915887 - F1-score 0.8842580570296852
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 11 - avg_train_loss: 1.2960             avg_val_loss: 1.3039  time: 302s
Epoch 11 - Accuracy: 0.8892523364485981 - F1-score 0.888153789442278
Number of bad epochs 2
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 1.2915             avg_val_loss: 1.2994  time: 302s
Epoch 12 - Accuracy: 0.8936915887850467 - F1-score 0.8927047363126591
Epoch 12 - Save Best Accuracy: 0.8937 -                 Save Best F1-score: 0.8927 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 13 - avg_train_loss: 1.2880             avg_val_loss: 1.3013  time: 302s
Epoch 13 - Accuracy: 0.8929906542056075 - F1-score 0.8916636668353848
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 14 - avg_train_loss: 1.2891             avg_val_loss: 1.3034  time: 302s
Epoch 14 - Accuracy: 0.891822429906542 - F1-score 0.8910341370892273
Number of bad epochs 2
Current learning rate: 0.0071875
Epoch 15 - avg_train_loss: 1.2886             avg_val_loss: 1.3029  time: 302s
Epoch 15 - Accuracy: 0.8897196261682243 - F1-score 0.8894478010481469
Number of bad epochs 3
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 1.2869             avg_val_loss: 1.3011  time: 302s
Epoch 16 - Accuracy: 0.8880841121495328 - F1-score 0.8871922498839999
Number of bad epochs 4
Current learning rate: 0.00409375
Epoch 17 - avg_train_loss: 1.2857             avg_val_loss: 1.3007  time: 303s
Epoch 17 - Accuracy: 0.8929906542056075 - F1-score 0.8922187694509339
Number of bad epochs 5
Current learning rate: 0.0071875
Epoch 18 - avg_train_loss: 1.2860             avg_val_loss: 1.3010  time: 302s
Epoch 18 - Accuracy: 0.8941588785046729 - F1-score 0.8930118751632813
Epoch 18 - Save Best Accuracy: 0.8942 -                 Save Best F1-score: 0.8930 Model
Number of bad epochs 0
Current learning rate: 0.00409375
Epoch 19 - avg_train_loss: 1.2848             avg_val_loss: 1.3023  time: 303s
Epoch 19 - Accuracy: 0.888785046728972 - F1-score 0.8873703227196412
Number of bad epochs 1
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 1.2835             avg_val_loss: 1.3017  time: 302s
Epoch 20 - Accuracy: 0.8899532710280373 - F1-score 0.8893703622044087
Number of bad epochs 2
Current learning rate: 0.002546875
Epoch 21 - avg_train_loss: 1.2819             avg_val_loss: 1.3023  time: 303s
Epoch 21 - Accuracy: 0.8876168224299066 - F1-score 0.8867600813635165
Number of bad epochs 3
Current learning rate: 0.00409375
Epoch 22 - avg_train_loss: 1.2825             avg_val_loss: 1.3036  time: 302s
Epoch 22 - Accuracy: 0.8873831775700934 - F1-score 0.886569182389905
Number of bad epochs 4
Current learning rate: 0.002546875
Epoch 23 - avg_train_loss: 1.2815             avg_val_loss: 1.3021  time: 303s
Epoch 23 - Accuracy: 0.8899532710280373 - F1-score 0.88937941133135
Number of bad epochs 5
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 1.2813             avg_val_loss: 1.3027  time: 302s
Epoch 24 - Accuracy: 0.888785046728972 - F1-score 0.8884059326047306
Number of bad epochs 6
Current learning rate: 0.0017734375
Epoch 25 - avg_train_loss: 1.2804             avg_val_loss: 1.3031  time: 303s
Epoch 25 - Accuracy: 0.8871495327102804 - F1-score 0.8864400130358168
Number of bad epochs 7
Current learning rate: 0.002546875
Epoch 26 - avg_train_loss: 1.2814             avg_val_loss: 1.3022  time: 303s
Epoch 26 - Accuracy: 0.8897196261682243 - F1-score 0.8888485578712697
Number of bad epochs 8
Current learning rate: 0.0017734375
Epoch 27 - avg_train_loss: 1.2803             avg_val_loss: 1.3030  time: 303s
Epoch 27 - Accuracy: 0.8878504672897196 - F1-score 0.8869324618877024
Number of bad epochs 9
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 1.2800             avg_val_loss: 1.3020  time: 303s
Epoch 28 - Accuracy: 0.8913551401869159 - F1-score 0.890405932312639
Number of bad epochs 10
Current learning rate: 0.00138671875
Epoch 29 - avg_train_loss: 1.2801             avg_val_loss: 1.3030  time: 303s
Epoch 29 - Accuracy: 0.8892523364485981 - F1-score 0.887773761286722
Number of bad epochs 11
Current learning rate: 0.0017734375
Epoch 30 - avg_train_loss: 1.2799             avg_val_loss: 1.3036  time: 303s
Epoch 30 - Accuracy: 0.8862149532710281 - F1-score 0.8853377409421684
Number of bad epochs 12
Current learning rate: 0.00138671875
Epoch 31 - avg_train_loss: 1.2791             avg_val_loss: 1.3029  time: 302s
Epoch 31 - Accuracy: 0.8899532710280373 - F1-score 0.889247368043072
Number of bad epochs 13
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 1.2798             avg_val_loss: 1.3030  time: 302s
Epoch 32 - Accuracy: 0.8880841121495328 - F1-score 0.8872304898804073
Number of bad epochs 14
Current learning rate: 0.001193359375
Epoch 33 - avg_train_loss: 1.2792             avg_val_loss: 1.3032  time: 302s
Epoch 33 - Accuracy: 0.8885514018691589 - F1-score 0.8874527569606702
Number of bad epochs 15
Current learning rate: 0.00138671875
Epoch 34 - avg_train_loss: 1.2794             avg_val_loss: 1.3038  time: 302s
Epoch 34 - Accuracy: 0.8883177570093458 - F1-score 0.8869318771387381
Number of bad epochs 16
Current learning rate: 0.001193359375
Epoch 35 - avg_train_loss: 1.2789             avg_val_loss: 1.3029  time: 303s
Epoch 35 - Accuracy: 0.8901869158878505 - F1-score 0.8890414424852591
Number of bad epochs 17
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 1.2779             avg_val_loss: 1.3033  time: 302s
Epoch 36 - Accuracy: 0.8904205607476635 - F1-score 0.889523062334852
Number of bad epochs 18
Current learning rate: 0.0010966796875
Epoch 37 - avg_train_loss: 1.2775             avg_val_loss: 1.3038  time: 302s
Epoch 37 - Accuracy: 0.889018691588785 - F1-score 0.8882027079245979
Number of bad epochs 19
Current learning rate: 0.001193359375
Epoch 38 - avg_train_loss: 1.2783             avg_val_loss: 1.3035  time: 303s
Epoch 38 - Accuracy: 0.8897196261682243 - F1-score 0.888262661245966
Number of bad epochs 20
Current learning rate: 0.0010966796875
Epoch 39 - avg_train_loss: 1.2784             avg_val_loss: 1.3033  time: 303s
Epoch 39 - Accuracy: 0.8880841121495328 - F1-score 0.8869989455672257
Number of bad epochs 21
Stop the training, since the score has not improved for 20 epochs!
AFTER TRAINING: Epoch 18: Best Accuracy: 0.8942 -                 Best F1-score: 0.8930
