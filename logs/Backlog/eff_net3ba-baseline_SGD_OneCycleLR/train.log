Reading data...
Weight list for classes: [1.         0.49657378 0.45557418 0.08261134 0.4218083 ]
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.3728             avg_val_loss: 1.3917  time: 294s
Epoch 1 - Accuracy: 0.8598130841121495 - F1-score 0.8571590597906792
Epoch 1 - Save Best Accuracy: 0.8598 -                 Save Best F1-score: 0.8572 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.3363             avg_val_loss: 3.1435  time: 299s
Epoch 2 - Accuracy: 0.8633177570093458 - F1-score 0.8624490424124253
Epoch 2 - Save Best Accuracy: 0.8633 -                 Save Best F1-score: 0.8624 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 1.3254             avg_val_loss: 2.0202  time: 300s
Epoch 3 - Accuracy: 0.8773364485981309 - F1-score 0.8745955965617842
Epoch 3 - Save Best Accuracy: 0.8773 -                 Save Best F1-score: 0.8746 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 1.3199             avg_val_loss: 1.3259  time: 300s
Epoch 4 - Accuracy: 0.8827102803738318 - F1-score 0.8819220530646277
Epoch 4 - Save Best Accuracy: 0.8827 -                 Save Best F1-score: 0.8819 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 1.3190             avg_val_loss: 1.4191  time: 301s
Epoch 5 - Accuracy: 0.8813084112149533 - F1-score 0.8785178328371707
Number of bad epochs 1
Epoch 6 - avg_train_loss: 1.3173             avg_val_loss: 1.3416  time: 301s
Epoch 6 - Accuracy: 0.8773364485981309 - F1-score 0.8740701814722511
Number of bad epochs 2
Epoch 7 - avg_train_loss: 1.3160             avg_val_loss: 1.3376  time: 301s
Epoch 7 - Accuracy: 0.8838785046728972 - F1-score 0.8825486680069361
Epoch 7 - Save Best Accuracy: 0.8839 -                 Save Best F1-score: 0.8825 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 1.3121             avg_val_loss: 1.3124  time: 301s
Epoch 8 - Accuracy: 0.8792056074766356 - F1-score 0.8788668923605797
Number of bad epochs 1
Epoch 9 - avg_train_loss: 1.3101             avg_val_loss: 1.3077  time: 301s
Epoch 9 - Accuracy: 0.8859813084112149 - F1-score 0.8856925968928637
Epoch 9 - Save Best Accuracy: 0.8860 -                 Save Best F1-score: 0.8857 Model
Number of bad epochs 0
Epoch 10 - avg_train_loss: 1.3098             avg_val_loss: 1.3103  time: 300s
Epoch 10 - Accuracy: 0.8785046728971962 - F1-score 0.8777721269738555
Number of bad epochs 1
Epoch 11 - avg_train_loss: 1.3060             avg_val_loss: 1.3124  time: 301s
Epoch 11 - Accuracy: 0.8838785046728972 - F1-score 0.8811957119176606
Number of bad epochs 2
Epoch 12 - avg_train_loss: 1.3053             avg_val_loss: 1.3100  time: 301s
Epoch 12 - Accuracy: 0.8785046728971962 - F1-score 0.8768969333381728
Number of bad epochs 3
Epoch 13 - avg_train_loss: 1.3007             avg_val_loss: 1.3160  time: 301s
Epoch 13 - Accuracy: 0.8689252336448599 - F1-score 0.8710737316158915
Number of bad epochs 4
Epoch 14 - avg_train_loss: 1.3017             avg_val_loss: 1.3087  time: 301s
Epoch 14 - Accuracy: 0.880607476635514 - F1-score 0.8794683889545726
Number of bad epochs 5
Epoch 15 - avg_train_loss: 1.2996             avg_val_loss: 1.3092  time: 301s
Epoch 15 - Accuracy: 0.8766355140186916 - F1-score 0.87688432538155
Number of bad epochs 6
Epoch 16 - avg_train_loss: 1.2954             avg_val_loss: 1.3145  time: 301s
Epoch 16 - Accuracy: 0.8810747663551401 - F1-score 0.8777866347723058
Number of bad epochs 7
Epoch 17 - avg_train_loss: 1.2944             avg_val_loss: 1.3080  time: 301s
Epoch 17 - Accuracy: 0.8862149532710281 - F1-score 0.8856383219537647
Number of bad epochs 8
Epoch 18 - avg_train_loss: 1.2939             avg_val_loss: 1.3098  time: 301s
Epoch 18 - Accuracy: 0.8815420560747663 - F1-score 0.8823209849024031
Number of bad epochs 9
Epoch 19 - avg_train_loss: 1.2911             avg_val_loss: 1.3102  time: 301s
Epoch 19 - Accuracy: 0.8824766355140187 - F1-score 0.8814402395303843
Number of bad epochs 10
Epoch 20 - avg_train_loss: 1.2890             avg_val_loss: 1.3148  time: 301s
Epoch 20 - Accuracy: 0.8742990654205608 - F1-score 0.8750875416685676
Number of bad epochs 11
Epoch 21 - avg_train_loss: 1.2885             avg_val_loss: 1.3189  time: 301s
Epoch 21 - Accuracy: 0.8647196261682243 - F1-score 0.8668988635051988
Number of bad epochs 12
Epoch 22 - avg_train_loss: 1.2867             avg_val_loss: 1.3077  time: 300s
Epoch 22 - Accuracy: 0.8838785046728972 - F1-score 0.8814404006625349
Number of bad epochs 13
Epoch 23 - avg_train_loss: 1.2853             avg_val_loss: 1.3141  time: 301s
Epoch 23 - Accuracy: 0.8719626168224299 - F1-score 0.8716298596304701
Number of bad epochs 14
Epoch 24 - avg_train_loss: 1.2833             avg_val_loss: 1.3148  time: 300s
Epoch 24 - Accuracy: 0.8705607476635514 - F1-score 0.869578137647274
Number of bad epochs 15
Epoch 25 - avg_train_loss: 1.2824             avg_val_loss: 1.3226  time: 301s
Epoch 25 - Accuracy: 0.8803738317757009 - F1-score 0.8792925567371853
Number of bad epochs 16
Epoch 26 - avg_train_loss: 1.2805             avg_val_loss: 1.3103  time: 300s
Epoch 26 - Accuracy: 0.8796728971962616 - F1-score 0.8788292418047982
Number of bad epochs 17
Epoch 27 - avg_train_loss: 1.2797             avg_val_loss: 1.3145  time: 300s
Epoch 27 - Accuracy: 0.8719626168224299 - F1-score 0.8682432887511216
Number of bad epochs 18
Epoch 28 - avg_train_loss: 1.2776             avg_val_loss: 1.3152  time: 300s
Epoch 28 - Accuracy: 0.8740654205607477 - F1-score 0.8743132567181181
Number of bad epochs 19
Epoch 29 - avg_train_loss: 1.2755             avg_val_loss: 1.3175  time: 301s
Epoch 29 - Accuracy: 0.8698598130841122 - F1-score 0.8687993162690031
Number of bad epochs 20
Epoch 30 - avg_train_loss: 1.2742             avg_val_loss: 1.3141  time: 300s
Epoch 30 - Accuracy: 0.8738317757009346 - F1-score 0.872696148762141
Number of bad epochs 21
Stop the training, since the score has not improved for 20 epochs!
AFTER TRAINING: Epoch 9: Best Accuracy: 0.8862 -                 Best F1-score: 0.8857
