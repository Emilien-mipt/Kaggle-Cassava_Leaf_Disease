Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.5971             avg_val_loss: 0.5041  time: 304s
Epoch 1 - Accuracy: 0.8238317757009346 - F1-score 0.8255281601596297
Epoch 1 - Save Best Accuracy: 0.8238 -                 Save Best F1-score: 0.8255 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.4926             avg_val_loss: 0.4514  time: 312s
Epoch 2 - Accuracy: 0.8469626168224299 - F1-score 0.8468984890637198
Epoch 2 - Save Best Accuracy: 0.8470 -                 Save Best F1-score: 0.8469 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.4645             avg_val_loss: 0.4275  time: 313s
Epoch 3 - Accuracy: 0.8563084112149533 - F1-score 0.8555161402462462
Epoch 3 - Save Best Accuracy: 0.8563 -                 Save Best F1-score: 0.8555 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.4510             avg_val_loss: 0.4977  time: 313s
Epoch 4 - Accuracy: 0.8313084112149532 - F1-score 0.8339979289240641
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.4381             avg_val_loss: 0.3960  time: 313s
Epoch 5 - Accuracy: 0.8672897196261682 - F1-score 0.8674187433292845
Epoch 5 - Save Best Accuracy: 0.8673 -                 Save Best F1-score: 0.8674 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.4292             avg_val_loss: 0.3975  time: 313s
Epoch 6 - Accuracy: 0.8656542056074766 - F1-score 0.8657543600595
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.4213             avg_val_loss: 0.3965  time: 313s
Epoch 7 - Accuracy: 0.8707943925233644 - F1-score 0.8705700857812457
Epoch 7 - Save Best Accuracy: 0.8708 -                 Save Best F1-score: 0.8706 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 0.4132             avg_val_loss: 0.4204  time: 313s
Epoch 8 - Accuracy: 0.8630841121495327 - F1-score 0.8630724740365802
Number of bad epochs 1
Epoch 9 - avg_train_loss: 0.4147             avg_val_loss: 0.4020  time: 313s
Epoch 9 - Accuracy: 0.8654205607476636 - F1-score 0.8645037564838988
Number of bad epochs 2
Epoch 10 - avg_train_loss: 0.4004             avg_val_loss: 0.5765  time: 313s
Epoch 10 - Accuracy: 0.8658878504672897 - F1-score 0.8636969097271645
Number of bad epochs 3
Epoch 11 - avg_train_loss: 0.3940             avg_val_loss: 0.4273  time: 313s
Epoch 11 - Accuracy: 0.8623831775700934 - F1-score 0.8616598632133775
Number of bad epochs 4
Epoch 12 - avg_train_loss: 0.3914             avg_val_loss: 0.3768  time: 313s
Epoch 12 - Accuracy: 0.8759345794392523 - F1-score 0.8720872188246916
Epoch 12 - Save Best Accuracy: 0.8759 -                 Save Best F1-score: 0.8721 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 0.3836             avg_val_loss: 0.7071  time: 313s
Epoch 13 - Accuracy: 0.866588785046729 - F1-score 0.8677253840165122
Number of bad epochs 1
Epoch 14 - avg_train_loss: 0.3786             avg_val_loss: 0.4332  time: 313s
Epoch 14 - Accuracy: 0.8616822429906542 - F1-score 0.8645590885227155
Number of bad epochs 2
Epoch 15 - avg_train_loss: 0.3731             avg_val_loss: 0.3823  time: 313s
Epoch 15 - Accuracy: 0.8738317757009346 - F1-score 0.8745720484950311
Number of bad epochs 3
Epoch 16 - avg_train_loss: 0.3734             avg_val_loss: 0.4187  time: 313s
Epoch 16 - Accuracy: 0.8691588785046729 - F1-score 0.8664979149229837
Number of bad epochs 4
Epoch 17 - avg_train_loss: 0.3722             avg_val_loss: 0.3900  time: 313s
Epoch 17 - Accuracy: 0.8768691588785047 - F1-score 0.8750640481725658
Epoch 17 - Save Best Accuracy: 0.8769 -                 Save Best F1-score: 0.8751 Model
Number of bad epochs 0
Epoch 18 - avg_train_loss: 0.3631             avg_val_loss: 0.3811  time: 313s
Epoch 18 - Accuracy: 0.874766355140187 - F1-score 0.8743994338252592
Number of bad epochs 1
Epoch 19 - avg_train_loss: 0.3641             avg_val_loss: 0.3664  time: 313s
Epoch 19 - Accuracy: 0.877803738317757 - F1-score 0.8763919996383287
Epoch 19 - Save Best Accuracy: 0.8778 -                 Save Best F1-score: 0.8764 Model
Number of bad epochs 0
Epoch 20 - avg_train_loss: 0.3536             avg_val_loss: 0.3817  time: 313s
Epoch 20 - Accuracy: 0.8738317757009346 - F1-score 0.8723174507506695
Number of bad epochs 1
Epoch 21 - avg_train_loss: 0.3572             avg_val_loss: 0.3567  time: 313s
Epoch 21 - Accuracy: 0.8789719626168224 - F1-score 0.8772644783336202
Epoch 21 - Save Best Accuracy: 0.8790 -                 Save Best F1-score: 0.8773 Model
Number of bad epochs 0
Epoch 22 - avg_train_loss: 0.3470             avg_val_loss: 0.4042  time: 313s
Epoch 22 - Accuracy: 0.8696261682242991 - F1-score 0.8712447019069255
Number of bad epochs 1
Epoch 23 - avg_train_loss: 0.3464             avg_val_loss: 0.3671  time: 313s
Epoch 23 - Accuracy: 0.883177570093458 - F1-score 0.8818021282068086
Epoch 23 - Save Best Accuracy: 0.8832 -                 Save Best F1-score: 0.8818 Model
Number of bad epochs 0
Epoch 24 - avg_train_loss: 0.3419             avg_val_loss: 0.3602  time: 313s
Epoch 24 - Accuracy: 0.8824766355140187 - F1-score 0.8809291411573568
Number of bad epochs 1
Epoch 25 - avg_train_loss: 0.3378             avg_val_loss: 0.3888  time: 313s
Epoch 25 - Accuracy: 0.8726635514018691 - F1-score 0.8724685197450781
Number of bad epochs 2
Epoch 26 - avg_train_loss: 0.3341             avg_val_loss: 0.3906  time: 313s
Epoch 26 - Accuracy: 0.8742990654205608 - F1-score 0.8721190009696745
Number of bad epochs 3
Epoch 27 - avg_train_loss: 0.3321             avg_val_loss: 0.3950  time: 313s
Epoch 27 - Accuracy: 0.8731308411214953 - F1-score 0.8721340545911076
Number of bad epochs 4
Epoch 28 - avg_train_loss: 0.3342             avg_val_loss: 0.3848  time: 313s
Epoch 28 - Accuracy: 0.8738317757009346 - F1-score 0.8727704480154536
Number of bad epochs 5
Epoch 29 - avg_train_loss: 0.3294             avg_val_loss: 0.3831  time: 313s
Epoch 29 - Accuracy: 0.8780373831775701 - F1-score 0.8754413929811903
Number of bad epochs 6
Epoch 30 - avg_train_loss: 0.3240             avg_val_loss: 0.4248  time: 313s
Epoch 30 - Accuracy: 0.866588785046729 - F1-score 0.8637641753682931
Number of bad epochs 7
Epoch 31 - avg_train_loss: 0.3214             avg_val_loss: 0.4068  time: 313s
Epoch 31 - Accuracy: 0.866822429906542 - F1-score 0.867699644534294
Number of bad epochs 8
Epoch 32 - avg_train_loss: 0.3230             avg_val_loss: 0.4112  time: 313s
Epoch 32 - Accuracy: 0.8572429906542056 - F1-score 0.8599044047412553
Number of bad epochs 9
Epoch 33 - avg_train_loss: 0.3106             avg_val_loss: 0.3634  time: 313s
Epoch 33 - Accuracy: 0.877803738317757 - F1-score 0.8765656175632137
Number of bad epochs 10
Epoch 34 - avg_train_loss: 0.3111             avg_val_loss: 0.3911  time: 313s
Epoch 34 - Accuracy: 0.8726635514018691 - F1-score 0.8700367890419138
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 23: Best Accuracy: 0.8832 -                 Best F1-score: 0.8818
