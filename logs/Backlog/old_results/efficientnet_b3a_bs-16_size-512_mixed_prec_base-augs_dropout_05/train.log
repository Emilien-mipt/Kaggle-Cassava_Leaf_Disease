Reading data...
Weight list for classes: [1.         0.49657378 0.45557418 0.08261134 0.4218083 ]
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.6066             avg_val_loss: 0.4582  time: 306s
Epoch 1 - Accuracy: 0.8453271028037384 - F1-score 0.8451553577366505
Epoch 1 - Save Best Accuracy: 0.8453 -                 Save Best F1-score: 0.8452 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.5079             avg_val_loss: 0.4792  time: 313s
Epoch 2 - Accuracy: 0.8341121495327103 - F1-score 0.830979214365605
Number of bad epochs 1
Epoch 3 - avg_train_loss: 0.4766             avg_val_loss: 0.4363  time: 314s
Epoch 3 - Accuracy: 0.8523364485981308 - F1-score 0.8499875362725497
Epoch 3 - Save Best Accuracy: 0.8523 -                 Save Best F1-score: 0.8500 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.4619             avg_val_loss: 0.4693  time: 314s
Epoch 4 - Accuracy: 0.8429906542056075 - F1-score 0.8464828209565836
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.4476             avg_val_loss: 0.3942  time: 315s
Epoch 5 - Accuracy: 0.8672897196261682 - F1-score 0.8698136140264882
Epoch 5 - Save Best Accuracy: 0.8673 -                 Save Best F1-score: 0.8698 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.4404             avg_val_loss: 0.4496  time: 314s
Epoch 6 - Accuracy: 0.8432242990654205 - F1-score 0.8449815600543397
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.4322             avg_val_loss: 0.4061  time: 315s
Epoch 7 - Accuracy: 0.8586448598130841 - F1-score 0.8605725120407225
Number of bad epochs 2
Epoch 8 - avg_train_loss: 0.4257             avg_val_loss: 0.3935  time: 315s
Epoch 8 - Accuracy: 0.8682242990654205 - F1-score 0.8701182496617738
Epoch 8 - Save Best Accuracy: 0.8682 -                 Save Best F1-score: 0.8701 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 0.4226             avg_val_loss: 0.4048  time: 315s
Epoch 9 - Accuracy: 0.8644859813084113 - F1-score 0.8625722323119117
Number of bad epochs 1
Epoch 10 - avg_train_loss: 0.4113             avg_val_loss: 0.3900  time: 315s
Epoch 10 - Accuracy: 0.8735981308411215 - F1-score 0.8727969979417745
Epoch 10 - Save Best Accuracy: 0.8736 -                 Save Best F1-score: 0.8728 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 0.4044             avg_val_loss: 0.3972  time: 315s
Epoch 11 - Accuracy: 0.8691588785046729 - F1-score 0.8677112207915505
Number of bad epochs 1
Epoch 12 - avg_train_loss: 0.4017             avg_val_loss: 0.3729  time: 314s
Epoch 12 - Accuracy: 0.8808411214953271 - F1-score 0.8772281161758865
Epoch 12 - Save Best Accuracy: 0.8808 -                 Save Best F1-score: 0.8772 Model
Number of bad epochs 0
Epoch 13 - avg_train_loss: 0.3943             avg_val_loss: 0.3833  time: 314s
Epoch 13 - Accuracy: 0.8707943925233644 - F1-score 0.8708744242260721
Number of bad epochs 1
Epoch 14 - avg_train_loss: 0.3889             avg_val_loss: 0.4068  time: 314s
Epoch 14 - Accuracy: 0.8754672897196262 - F1-score 0.8769501620208401
Number of bad epochs 2
Epoch 15 - avg_train_loss: 0.3804             avg_val_loss: 0.3785  time: 314s
Epoch 15 - Accuracy: 0.875 - F1-score 0.8761994835163969
Number of bad epochs 3
Epoch 16 - avg_train_loss: 0.3804             avg_val_loss: 0.4113  time: 315s
Epoch 16 - Accuracy: 0.866588785046729 - F1-score 0.8655457691403645
Number of bad epochs 4
Epoch 17 - avg_train_loss: 0.3816             avg_val_loss: 0.3854  time: 314s
Epoch 17 - Accuracy: 0.8710280373831776 - F1-score 0.8701143318519352
Number of bad epochs 5
Epoch 18 - avg_train_loss: 0.3761             avg_val_loss: 0.3591  time: 314s
Epoch 18 - Accuracy: 0.8869158878504673 - F1-score 0.8858315204808447
Epoch 18 - Save Best Accuracy: 0.8869 -                 Save Best F1-score: 0.8858 Model
Number of bad epochs 0
Epoch 19 - avg_train_loss: 0.3720             avg_val_loss: 0.3769  time: 315s
Epoch 19 - Accuracy: 0.875233644859813 - F1-score 0.8754558865189984
Number of bad epochs 1
Epoch 20 - avg_train_loss: 0.3627             avg_val_loss: 0.3873  time: 314s
Epoch 20 - Accuracy: 0.8754672897196262 - F1-score 0.8741975885483698
Number of bad epochs 2
Epoch 21 - avg_train_loss: 0.3622             avg_val_loss: 0.3681  time: 315s
Epoch 21 - Accuracy: 0.883177570093458 - F1-score 0.8810393242297604
Number of bad epochs 3
Epoch 22 - avg_train_loss: 0.3572             avg_val_loss: 0.4452  time: 314s
Epoch 22 - Accuracy: 0.8644859813084113 - F1-score 0.8662536151828009
Number of bad epochs 4
Epoch 23 - avg_train_loss: 0.3586             avg_val_loss: 0.3504  time: 314s
Epoch 23 - Accuracy: 0.8852803738317757 - F1-score 0.8849147723656453
Number of bad epochs 5
Epoch 24 - avg_train_loss: 0.3515             avg_val_loss: 0.3704  time: 314s
Epoch 24 - Accuracy: 0.8794392523364486 - F1-score 0.8803201226625427
Number of bad epochs 6
Epoch 25 - avg_train_loss: 0.3472             avg_val_loss: 0.4109  time: 314s
Epoch 25 - Accuracy: 0.8628504672897196 - F1-score 0.8639374080054357
Number of bad epochs 7
Epoch 26 - avg_train_loss: 0.3443             avg_val_loss: 0.3813  time: 314s
Epoch 26 - Accuracy: 0.8766355140186916 - F1-score 0.8748913396554175
Number of bad epochs 8
Epoch 27 - avg_train_loss: 0.3451             avg_val_loss: 0.3788  time: 314s
Epoch 27 - Accuracy: 0.8780373831775701 - F1-score 0.877947194579
Number of bad epochs 9
Epoch 28 - avg_train_loss: 0.3432             avg_val_loss: 0.3749  time: 314s
Epoch 28 - Accuracy: 0.8731308411214953 - F1-score 0.8738540166875849
Number of bad epochs 10
Epoch 29 - avg_train_loss: 0.3368             avg_val_loss: 0.3688  time: 314s
Epoch 29 - Accuracy: 0.8838785046728972 - F1-score 0.8820598709214819
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 18: Best Accuracy: 0.8869 -                 Best F1-score: 0.8858
