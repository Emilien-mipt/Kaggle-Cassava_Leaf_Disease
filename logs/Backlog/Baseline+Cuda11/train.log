Reading data...
Weight list for classes: [1.         0.49657378 0.45557418 0.08261134 0.4218083 ]
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.5989             avg_val_loss: 0.4461  time: 401s
Epoch 1 - Accuracy: 0.8462616822429907 - F1-score 0.8438176067221526
Epoch 1 - Save Best Accuracy: 0.8463 -                 Save Best F1-score: 0.8438 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.4950             avg_val_loss: 0.4958  time: 405s
Epoch 2 - Accuracy: 0.8280373831775701 - F1-score 0.8301433379663355
Number of bad epochs 1
Epoch 3 - avg_train_loss: 0.4659             avg_val_loss: 0.4116  time: 406s
Epoch 3 - Accuracy: 0.8635514018691589 - F1-score 0.8614534563353327
Epoch 3 - Save Best Accuracy: 0.8636 -                 Save Best F1-score: 0.8615 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.4546             avg_val_loss: 0.4144  time: 406s
Epoch 4 - Accuracy: 0.8630841121495327 - F1-score 0.8651510633054099
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.4431             avg_val_loss: 0.4383  time: 406s
Epoch 5 - Accuracy: 0.8635514018691589 - F1-score 0.8594331760867641
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.4337             avg_val_loss: 0.4011  time: 406s
Epoch 6 - Accuracy: 0.8670560747663552 - F1-score 0.8614228837603707
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.4215             avg_val_loss: 0.3885  time: 406s
Epoch 7 - Accuracy: 0.8686915887850467 - F1-score 0.8692267350481745
Epoch 7 - Save Best Accuracy: 0.8687 -                 Save Best F1-score: 0.8692 Model
Number of bad epochs 0
Epoch 8 - avg_train_loss: 0.4118             avg_val_loss: 0.3925  time: 406s
Epoch 8 - Accuracy: 0.8698598130841122 - F1-score 0.8706424518152502
Epoch 8 - Save Best Accuracy: 0.8699 -                 Save Best F1-score: 0.8706 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 0.4047             avg_val_loss: 0.3885  time: 406s
Epoch 9 - Accuracy: 0.8689252336448599 - F1-score 0.8680236262255918
Number of bad epochs 1
Epoch 10 - avg_train_loss: 0.4031             avg_val_loss: 0.3809  time: 406s
Epoch 10 - Accuracy: 0.8714953271028038 - F1-score 0.8716531816779746
Epoch 10 - Save Best Accuracy: 0.8715 -                 Save Best F1-score: 0.8717 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 0.3932             avg_val_loss: 0.3958  time: 406s
Epoch 11 - Accuracy: 0.8682242990654205 - F1-score 0.8635895518193647
Number of bad epochs 1
Epoch 12 - avg_train_loss: 0.3891             avg_val_loss: 0.4053  time: 406s
Epoch 12 - Accuracy: 0.8619158878504672 - F1-score 0.8563137778805194
Number of bad epochs 2
Epoch 13 - avg_train_loss: 0.3797             avg_val_loss: 0.3899  time: 405s
Epoch 13 - Accuracy: 0.8728971962616823 - F1-score 0.8723740110851732
Epoch 13 - Save Best Accuracy: 0.8729 -                 Save Best F1-score: 0.8724 Model
Number of bad epochs 0
Epoch 14 - avg_train_loss: 0.3879             avg_val_loss: 0.3756  time: 404s
Epoch 14 - Accuracy: 0.8740654205607477 - F1-score 0.8755402308470825
Epoch 14 - Save Best Accuracy: 0.8741 -                 Save Best F1-score: 0.8755 Model
Number of bad epochs 0
Epoch 15 - avg_train_loss: 0.3740             avg_val_loss: 0.3641  time: 404s
Epoch 15 - Accuracy: 0.8820093457943925 - F1-score 0.8815883818152022
Epoch 15 - Save Best Accuracy: 0.8820 -                 Save Best F1-score: 0.8816 Model
Number of bad epochs 0
Epoch 16 - avg_train_loss: 0.3663             avg_val_loss: 0.3716  time: 404s
Epoch 16 - Accuracy: 0.8792056074766356 - F1-score 0.8765653224368156
Number of bad epochs 1
Epoch 17 - avg_train_loss: 0.3673             avg_val_loss: 0.3782  time: 404s
Epoch 17 - Accuracy: 0.866822429906542 - F1-score 0.8690382341228802
Number of bad epochs 2
Epoch 18 - avg_train_loss: 0.3635             avg_val_loss: 0.3762  time: 403s
Epoch 18 - Accuracy: 0.8735981308411215 - F1-score 0.8740212901814982
Number of bad epochs 3
Epoch 19 - avg_train_loss: 0.3585             avg_val_loss: 0.3764  time: 404s
Epoch 19 - Accuracy: 0.8838785046728972 - F1-score 0.881544160402314
Number of bad epochs 4
Epoch 20 - avg_train_loss: 0.3521             avg_val_loss: 0.3517  time: 404s
Epoch 20 - Accuracy: 0.8841121495327103 - F1-score 0.8832493718073506
Epoch 20 - Save Best Accuracy: 0.8841 -                 Save Best F1-score: 0.8832 Model
Number of bad epochs 0
Epoch 21 - avg_train_loss: 0.3497             avg_val_loss: 0.4268  time: 404s
Epoch 21 - Accuracy: 0.8553738317757009 - F1-score 0.8585528184448026
Number of bad epochs 1
Epoch 22 - avg_train_loss: 0.3429             avg_val_loss: 0.3648  time: 403s
Epoch 22 - Accuracy: 0.8803738317757009 - F1-score 0.879007828920127
Number of bad epochs 2
Epoch 23 - avg_train_loss: 0.3455             avg_val_loss: 0.4027  time: 404s
Epoch 23 - Accuracy: 0.8640186915887851 - F1-score 0.8609855141183267
Number of bad epochs 3
Epoch 24 - avg_train_loss: 0.3393             avg_val_loss: 0.3696  time: 404s
Epoch 24 - Accuracy: 0.8775700934579439 - F1-score 0.8764137958052484
Number of bad epochs 4
Epoch 25 - avg_train_loss: 0.3356             avg_val_loss: 0.3588  time: 404s
Epoch 25 - Accuracy: 0.8799065420560748 - F1-score 0.8795428515265693
Number of bad epochs 5
Epoch 26 - avg_train_loss: 0.3321             avg_val_loss: 0.3851  time: 403s
Epoch 26 - Accuracy: 0.8731308411214953 - F1-score 0.8735404692860166
Number of bad epochs 6
Epoch 27 - avg_train_loss: 0.3319             avg_val_loss: 0.3952  time: 403s
Epoch 27 - Accuracy: 0.8696261682242991 - F1-score 0.8645275239814234
Number of bad epochs 7
Epoch 28 - avg_train_loss: 0.3229             avg_val_loss: 0.3902  time: 403s
Epoch 28 - Accuracy: 0.8691588785046729 - F1-score 0.8697310511978336
Number of bad epochs 8
Epoch 29 - avg_train_loss: 0.3227             avg_val_loss: 0.4841  time: 403s
Epoch 29 - Accuracy: 0.8616822429906542 - F1-score 0.8583847498835373
Number of bad epochs 9
Epoch 30 - avg_train_loss: 0.3192             avg_val_loss: 0.4155  time: 404s
Epoch 30 - Accuracy: 0.8731308411214953 - F1-score 0.8729614911348831
Number of bad epochs 10
Epoch 31 - avg_train_loss: 0.3178             avg_val_loss: 0.4140  time: 403s
Epoch 31 - Accuracy: 0.8705607476635514 - F1-score 0.8718800957821546
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 20: Best Accuracy: 0.8841 -                 Best F1-score: 0.8832
