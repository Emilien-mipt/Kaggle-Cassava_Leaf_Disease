Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Current learning rate: 0.001000213756448742
Epoch 1 - avg_train_loss: 1.3551             avg_val_loss: 1.3146  time: 299s
Epoch 1 - Accuracy: 0.8771028037383177 - F1-score 0.8759069716458988
Epoch 1 - Save Best Accuracy: 0.8771 -                 Save Best F1-score: 0.8759 Model
Number of bad epochs 0
Current learning rate: 0.050572735631614296
Epoch 2 - avg_train_loss: 1.3367             avg_val_loss: 1.3191  time: 301s
Epoch 2 - Accuracy: 0.8670560747663552 - F1-score 0.8661133240675044
Number of bad epochs 1
Current learning rate: 0.0010000534391410333
Epoch 3 - avg_train_loss: 1.3125             avg_val_loss: 1.3036  time: 301s
Epoch 3 - Accuracy: 0.8880841121495328 - F1-score 0.8875013537253345
Epoch 3 - Save Best Accuracy: 0.8881 -                 Save Best F1-score: 0.8875 Model
Number of bad epochs 0
Current learning rate: 0.08552749215805285
Epoch 4 - avg_train_loss: 1.3239             avg_val_loss: 1.3220  time: 301s
Epoch 4 - Accuracy: 0.8738317757009346 - F1-score 0.8730034906766325
Number of bad epochs 1
Current learning rate: 0.050536367825622645
Epoch 5 - avg_train_loss: 1.3151             avg_val_loss: 1.3045  time: 301s
Epoch 5 - Accuracy: 0.8808411214953271 - F1-score 0.8794104883589452
Number of bad epochs 2
Current learning rate: 0.015523939714176708
Epoch 6 - avg_train_loss: 1.3045             avg_val_loss: 1.3024  time: 301s
Epoch 6 - Accuracy: 0.8925233644859814 - F1-score 0.8918078272520666
Epoch 6 - Save Best Accuracy: 0.8925 -                 Save Best F1-score: 0.8918 Model
Number of bad epochs 0
Current learning rate: 0.0010000133597870581
Epoch 7 - avg_train_loss: 1.2971             avg_val_loss: 1.3014  time: 301s
Epoch 7 - Accuracy: 0.8943925233644859 - F1-score 0.89413189914077
Epoch 7 - Save Best Accuracy: 0.8944 -                 Save Best F1-score: 0.8941 Model
Number of bad epochs 0
Current learning rate: 0.09623899245623814
Epoch 8 - avg_train_loss: 1.3141             avg_val_loss: 1.3164  time: 301s
Epoch 8 - Accuracy: 0.8689252336448599 - F1-score 0.8677812581000481
Number of bad epochs 1
Current learning rate: 0.08551464127596
Epoch 9 - avg_train_loss: 1.3106             avg_val_loss: 1.3061  time: 301s
Epoch 9 - Accuracy: 0.883177570093458 - F1-score 0.8826891057106591
Number of bad epochs 2
Current learning rate: 0.0694596283699305
Epoch 10 - avg_train_loss: 1.3066             avg_val_loss: 1.3111  time: 301s
Epoch 10 - Accuracy: 0.8801401869158878 - F1-score 0.8805101630895263
Number of bad epochs 3
Current learning rate: 0.05051818391403827
Epoch 11 - avg_train_loss: 1.3001             avg_val_loss: 1.3056  time: 301s
Epoch 11 - Accuracy: 0.8857476635514019 - F1-score 0.8844070085145976
Number of bad epochs 4
Current learning rate: 0.03157397112207128
Epoch 12 - avg_train_loss: 1.2949             avg_val_loss: 1.3115  time: 301s
Epoch 12 - Accuracy: 0.8876168224299066 - F1-score 0.8867964784537271
Number of bad epochs 5
Current learning rate: 0.015511074661889952
Epoch 13 - avg_train_loss: 1.2883             avg_val_loss: 1.3037  time: 301s
Epoch 13 - Accuracy: 0.8920560747663552 - F1-score 0.891189186818385
Number of bad epochs 6
Current learning rate: 0.004774924909037862
Epoch 14 - avg_train_loss: 1.2867             avg_val_loss: 1.3067  time: 301s
Epoch 14 - Accuracy: 0.8925233644859814 - F1-score 0.8925155182524819
Number of bad epochs 7
Current learning rate: 0.0010000033399468785
Epoch 15 - avg_train_loss: 1.2834             avg_val_loss: 1.3046  time: 301s
Epoch 15 - Accuracy: 0.8936915887850467 - F1-score 0.8931322362152531
Number of bad epochs 8
Current learning rate: 0.09905064431386976
Epoch 16 - avg_train_loss: 1.3036             avg_val_loss: 1.3123  time: 301s
Epoch 16 - Accuracy: 0.875 - F1-score 0.871134469856417
Number of bad epochs 9
Current learning rate: 0.09623551542925925
Epoch 17 - avg_train_loss: 1.3039             avg_val_loss: 1.3083  time: 301s
Epoch 17 - Accuracy: 0.8838785046728972 - F1-score 0.8842244639453225
Number of bad epochs 10
Current learning rate: 0.09166279633547483
Epoch 18 - avg_train_loss: 1.3011             avg_val_loss: 1.3119  time: 301s
Epoch 18 - Accuracy: 0.8742990654205608 - F1-score 0.8750869500128876
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 7: Best Accuracy: 0.8944 -                 Best F1-score: 0.8941
