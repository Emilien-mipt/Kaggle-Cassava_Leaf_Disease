Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.6044             avg_val_loss: 0.4834  time: 307s
Epoch 1 - Accuracy: 0.8380841121495327 - F1-score 0.8375003607992871
Epoch 1 - Save Best Accuracy: 0.8381 -                 Save Best F1-score: 0.8375 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.5072             avg_val_loss: 0.4757  time: 314s
Epoch 2 - Accuracy: 0.8317757009345794 - F1-score 0.8355150232221358
Number of bad epochs 1
Epoch 3 - avg_train_loss: 0.4798             avg_val_loss: 0.4041  time: 315s
Epoch 3 - Accuracy: 0.8675233644859813 - F1-score 0.8640420090430051
Epoch 3 - Save Best Accuracy: 0.8675 -                 Save Best F1-score: 0.8640 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.4575             avg_val_loss: 0.4426  time: 315s
Epoch 4 - Accuracy: 0.8488317757009346 - F1-score 0.8507408004340817
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.4458             avg_val_loss: 0.4130  time: 315s
Epoch 5 - Accuracy: 0.8598130841121495 - F1-score 0.8633874051462729
Number of bad epochs 2
Epoch 6 - avg_train_loss: 0.4374             avg_val_loss: 0.4858  time: 315s
Epoch 6 - Accuracy: 0.8289719626168224 - F1-score 0.832841981930919
Number of bad epochs 3
Epoch 7 - avg_train_loss: 0.4315             avg_val_loss: 0.4096  time: 315s
Epoch 7 - Accuracy: 0.8621495327102804 - F1-score 0.8624860411653491
Number of bad epochs 4
Epoch 8 - avg_train_loss: 0.4177             avg_val_loss: 0.3890  time: 315s
Epoch 8 - Accuracy: 0.8675233644859813 - F1-score 0.8668152734424183
Number of bad epochs 5
Epoch 9 - avg_train_loss: 0.4144             avg_val_loss: 0.3797  time: 315s
Epoch 9 - Accuracy: 0.8740654205607477 - F1-score 0.8740882735971163
Epoch 9 - Save Best Accuracy: 0.8741 -                 Save Best F1-score: 0.8741 Model
Number of bad epochs 0
Epoch 10 - avg_train_loss: 0.4110             avg_val_loss: 0.3783  time: 315s
Epoch 10 - Accuracy: 0.8714953271028038 - F1-score 0.8713022381367101
Number of bad epochs 1
Epoch 11 - avg_train_loss: 0.4038             avg_val_loss: 0.3908  time: 315s
Epoch 11 - Accuracy: 0.8691588785046729 - F1-score 0.8693708130291802
Number of bad epochs 2
Epoch 12 - avg_train_loss: 0.4023             avg_val_loss: 0.3898  time: 315s
Epoch 12 - Accuracy: 0.8759345794392523 - F1-score 0.8721922903836944
Number of bad epochs 3
Epoch 13 - avg_train_loss: 0.3863             avg_val_loss: 0.3668  time: 315s
Epoch 13 - Accuracy: 0.8794392523364486 - F1-score 0.8791913318544787
Epoch 13 - Save Best Accuracy: 0.8794 -                 Save Best F1-score: 0.8792 Model
Number of bad epochs 0
Epoch 14 - avg_train_loss: 0.3852             avg_val_loss: 0.3819  time: 315s
Epoch 14 - Accuracy: 0.8766355140186916 - F1-score 0.876443786793796
Number of bad epochs 1
Epoch 15 - avg_train_loss: 0.3839             avg_val_loss: 0.3857  time: 315s
Epoch 15 - Accuracy: 0.8696261682242991 - F1-score 0.8716689526122007
Number of bad epochs 2
Epoch 16 - avg_train_loss: 0.3759             avg_val_loss: 0.3852  time: 315s
Epoch 16 - Accuracy: 0.8759345794392523 - F1-score 0.8740729258668051
Number of bad epochs 3
Epoch 17 - avg_train_loss: 0.3792             avg_val_loss: 0.3668  time: 315s
Epoch 17 - Accuracy: 0.8848130841121495 - F1-score 0.8840814799610502
Epoch 17 - Save Best Accuracy: 0.8848 -                 Save Best F1-score: 0.8841 Model
Number of bad epochs 0
Epoch 18 - avg_train_loss: 0.3790             avg_val_loss: 0.3885  time: 315s
Epoch 18 - Accuracy: 0.875 - F1-score 0.8708984643603417
Number of bad epochs 1
Epoch 19 - avg_train_loss: 0.3683             avg_val_loss: 0.3600  time: 315s
Epoch 19 - Accuracy: 0.8792056074766356 - F1-score 0.8789958416815943
Number of bad epochs 2
Epoch 20 - avg_train_loss: 0.3656             avg_val_loss: 0.3931  time: 315s
Epoch 20 - Accuracy: 0.8796728971962616 - F1-score 0.8767607398521872
Number of bad epochs 3
Epoch 21 - avg_train_loss: 0.3664             avg_val_loss: 0.3553  time: 315s
Epoch 21 - Accuracy: 0.8836448598130842 - F1-score 0.88218956426584
Number of bad epochs 4
Epoch 22 - avg_train_loss: 0.3588             avg_val_loss: 0.3796  time: 315s
Epoch 22 - Accuracy: 0.875 - F1-score 0.8748181551970153
Number of bad epochs 5
Epoch 23 - avg_train_loss: 0.3605             avg_val_loss: 0.3771  time: 315s
Epoch 23 - Accuracy: 0.8771028037383177 - F1-score 0.8752208628984857
Number of bad epochs 6
Epoch 24 - avg_train_loss: 0.3556             avg_val_loss: 0.3576  time: 315s
Epoch 24 - Accuracy: 0.8785046728971962 - F1-score 0.877564875470702
Number of bad epochs 7
Epoch 25 - avg_train_loss: 0.3549             avg_val_loss: 0.3793  time: 315s
Epoch 25 - Accuracy: 0.8731308411214953 - F1-score 0.8730927353088688
Number of bad epochs 8
Epoch 26 - avg_train_loss: 0.3473             avg_val_loss: 0.3675  time: 315s
Epoch 26 - Accuracy: 0.8836448598130842 - F1-score 0.8823283468228337
Number of bad epochs 9
Epoch 27 - avg_train_loss: 0.3436             avg_val_loss: 0.3656  time: 315s
Epoch 27 - Accuracy: 0.8803738317757009 - F1-score 0.8780694764984354
Number of bad epochs 10
Epoch 28 - avg_train_loss: 0.3378             avg_val_loss: 0.3589  time: 315s
Epoch 28 - Accuracy: 0.8820093457943925 - F1-score 0.8814096501331122
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 17: Best Accuracy: 0.8848 -                 Best F1-score: 0.8841
