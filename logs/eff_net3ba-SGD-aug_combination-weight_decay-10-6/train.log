Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Current learning rate: 0.0505
Epoch 1 - avg_train_loss: 1.3812             avg_val_loss: 1.3255  time: 363s
Epoch 1 - Accuracy: 0.8607476635514019 - F1-score 0.8581640362102294
Epoch 1 - Save Best Accuracy: 0.8607 -                 Save Best F1-score: 0.8582 Model
Number of bad epochs 0
Current learning rate: 0.1
Epoch 2 - avg_train_loss: 1.3397             avg_val_loss: 1.3262  time: 363s
Epoch 2 - Accuracy: 0.8672897196261682 - F1-score 0.8677813887225058
Epoch 2 - Save Best Accuracy: 0.8673 -                 Save Best F1-score: 0.8678 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 3 - avg_train_loss: 1.3286             avg_val_loss: 1.3160  time: 365s
Epoch 3 - Accuracy: 0.8768691588785047 - F1-score 0.8761176986879834
Epoch 3 - Save Best Accuracy: 0.8769 -                 Save Best F1-score: 0.8761 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 1.3148             avg_val_loss: 1.3031  time: 366s
Epoch 4 - Accuracy: 0.8904205607476635 - F1-score 0.8896109310504022
Epoch 4 - Save Best Accuracy: 0.8904 -                 Save Best F1-score: 0.8896 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 5 - avg_train_loss: 1.3089             avg_val_loss: 1.3035  time: 366s
Epoch 5 - Accuracy: 0.8908878504672897 - F1-score 0.889991985070784
Epoch 5 - Save Best Accuracy: 0.8909 -                 Save Best F1-score: 0.8900 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 6 - avg_train_loss: 1.3117             avg_val_loss: 1.3132  time: 366s
Epoch 6 - Accuracy: 0.8782710280373832 - F1-score 0.8792796067652145
Number of bad epochs 1
Current learning rate: 0.025750000000000002
Epoch 7 - avg_train_loss: 1.3109             avg_val_loss: 1.3037  time: 366s
Epoch 7 - Accuracy: 0.888785046728972 - F1-score 0.8886052196710067
Number of bad epochs 2
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 1.3030             avg_val_loss: 1.3013  time: 363s
Epoch 8 - Accuracy: 0.8906542056074767 - F1-score 0.8902762091656723
Number of bad epochs 3
Current learning rate: 0.013375000000000001
Epoch 9 - avg_train_loss: 1.3002             avg_val_loss: 1.3002  time: 363s
Epoch 9 - Accuracy: 0.891588785046729 - F1-score 0.8913714162009643
Epoch 9 - Save Best Accuracy: 0.8916 -                 Save Best F1-score: 0.8914 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 10 - avg_train_loss: 1.3016             avg_val_loss: 1.3022  time: 363s
Epoch 10 - Accuracy: 0.8894859813084112 - F1-score 0.8882057152778493
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 11 - avg_train_loss: 1.3011             avg_val_loss: 1.3015  time: 362s
Epoch 11 - Accuracy: 0.8922897196261682 - F1-score 0.8911939819883398
Number of bad epochs 2
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 1.2964             avg_val_loss: 1.2985  time: 362s
Epoch 12 - Accuracy: 0.8957943925233645 - F1-score 0.8955324545487243
Epoch 12 - Save Best Accuracy: 0.8958 -                 Save Best F1-score: 0.8955 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 13 - avg_train_loss: 1.2963             avg_val_loss: 1.2990  time: 363s
Epoch 13 - Accuracy: 0.8960280373831776 - F1-score 0.8949510965945932
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 14 - avg_train_loss: 1.2957             avg_val_loss: 1.3013  time: 363s
Epoch 14 - Accuracy: 0.8911214953271028 - F1-score 0.8907336738456741
Number of bad epochs 2
Current learning rate: 0.0071875
Epoch 15 - avg_train_loss: 1.2960             avg_val_loss: 1.3000  time: 363s
Epoch 15 - Accuracy: 0.8920560747663552 - F1-score 0.8915077037135996
Number of bad epochs 3
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 1.2935             avg_val_loss: 1.2986  time: 363s
Epoch 16 - Accuracy: 0.8955607476635514 - F1-score 0.8944368450536558
Number of bad epochs 4
Current learning rate: 0.00409375
Epoch 17 - avg_train_loss: 1.2919             avg_val_loss: 1.2990  time: 363s
Epoch 17 - Accuracy: 0.8932242990654206 - F1-score 0.892273533570352
Number of bad epochs 5
Current learning rate: 0.0071875
Epoch 18 - avg_train_loss: 1.2923             avg_val_loss: 1.2998  time: 363s
Epoch 18 - Accuracy: 0.8929906542056075 - F1-score 0.8921277246002822
Number of bad epochs 6
Current learning rate: 0.00409375
Epoch 19 - avg_train_loss: 1.2928             avg_val_loss: 1.3002  time: 363s
Epoch 19 - Accuracy: 0.8911214953271028 - F1-score 0.8899647286602579
Number of bad epochs 7
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 1.2912             avg_val_loss: 1.3002  time: 363s
Epoch 20 - Accuracy: 0.8906542056074767 - F1-score 0.8902544649738701
Number of bad epochs 8
Current learning rate: 0.002546875
Epoch 21 - avg_train_loss: 1.2900             avg_val_loss: 1.3000  time: 363s
Epoch 21 - Accuracy: 0.8925233644859814 - F1-score 0.8920458166401044
Number of bad epochs 9
Current learning rate: 0.00409375
Epoch 22 - avg_train_loss: 1.2900             avg_val_loss: 1.3018  time: 367s
Epoch 22 - Accuracy: 0.8911214953271028 - F1-score 0.8910082978347683
Number of bad epochs 10
Current learning rate: 0.002546875
Epoch 23 - avg_train_loss: 1.2900             avg_val_loss: 1.2999  time: 365s
Epoch 23 - Accuracy: 0.8929906542056075 - F1-score 0.8924447871762469
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 12: Best Accuracy: 0.8960 -                 Best F1-score: 0.8955
