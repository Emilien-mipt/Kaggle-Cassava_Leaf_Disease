Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Current learning rate: 0.0505
Epoch 1 - avg_train_loss: 1.3811             avg_val_loss: 1.3285  time: 363s
Epoch 1 - Accuracy: 0.8535046728971962 - F1-score 0.8501180799570238
Epoch 1 - Save Best Accuracy: 0.8535 -                 Save Best F1-score: 0.8501 Model
Number of bad epochs 0
Current learning rate: 0.1
Epoch 2 - avg_train_loss: 1.3398             avg_val_loss: 1.3231  time: 361s
Epoch 2 - Accuracy: 0.8691588785046729 - F1-score 0.8694356731901558
Epoch 2 - Save Best Accuracy: 0.8692 -                 Save Best F1-score: 0.8694 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 3 - avg_train_loss: 1.3282             avg_val_loss: 1.3150  time: 362s
Epoch 3 - Accuracy: 0.8785046728971962 - F1-score 0.877541246297745
Epoch 3 - Save Best Accuracy: 0.8785 -                 Save Best F1-score: 0.8775 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 1.3148             avg_val_loss: 1.3027  time: 362s
Epoch 4 - Accuracy: 0.8883177570093458 - F1-score 0.8874630433350165
Epoch 4 - Save Best Accuracy: 0.8883 -                 Save Best F1-score: 0.8875 Model
Number of bad epochs 0
Current learning rate: 0.025750000000000002
Epoch 5 - avg_train_loss: 1.3092             avg_val_loss: 1.3048  time: 362s
Epoch 5 - Accuracy: 0.889018691588785 - F1-score 0.8875623090919709
Epoch 5 - Save Best Accuracy: 0.8890 -                 Save Best F1-score: 0.8876 Model
Number of bad epochs 0
Current learning rate: 0.0505
Epoch 6 - avg_train_loss: 1.3117             avg_val_loss: 1.3113  time: 362s
Epoch 6 - Accuracy: 0.8764018691588785 - F1-score 0.8764841994533233
Number of bad epochs 1
Current learning rate: 0.025750000000000002
Epoch 7 - avg_train_loss: 1.3117             avg_val_loss: 1.3048  time: 362s
Epoch 7 - Accuracy: 0.8869158878504673 - F1-score 0.8867858777917328
Number of bad epochs 2
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 1.3034             avg_val_loss: 1.3015  time: 362s
Epoch 8 - Accuracy: 0.8943925233644859 - F1-score 0.8937079772859366
Epoch 8 - Save Best Accuracy: 0.8944 -                 Save Best F1-score: 0.8937 Model
Number of bad epochs 0
Current learning rate: 0.013375000000000001
Epoch 9 - avg_train_loss: 1.3004             avg_val_loss: 1.3005  time: 362s
Epoch 9 - Accuracy: 0.8925233644859814 - F1-score 0.8919057548199806
Number of bad epochs 1
Current learning rate: 0.025750000000000002
Epoch 10 - avg_train_loss: 1.3022             avg_val_loss: 1.3026  time: 362s
Epoch 10 - Accuracy: 0.8897196261682243 - F1-score 0.8882071705387922
Number of bad epochs 2
Current learning rate: 0.013375000000000001
Epoch 11 - avg_train_loss: 1.3017             avg_val_loss: 1.3016  time: 362s
Epoch 11 - Accuracy: 0.8906542056074767 - F1-score 0.8892301610985548
Number of bad epochs 3
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 1.2968             avg_val_loss: 1.2990  time: 362s
Epoch 12 - Accuracy: 0.8953271028037383 - F1-score 0.8945849953388458
Epoch 12 - Save Best Accuracy: 0.8953 -                 Save Best F1-score: 0.8946 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 13 - avg_train_loss: 1.2964             avg_val_loss: 1.2991  time: 366s
Epoch 13 - Accuracy: 0.8950934579439253 - F1-score 0.8939965758560832
Number of bad epochs 1
Current learning rate: 0.013375000000000001
Epoch 14 - avg_train_loss: 1.2962             avg_val_loss: 1.3021  time: 362s
Epoch 14 - Accuracy: 0.8946261682242991 - F1-score 0.8936051507288266
Number of bad epochs 2
Current learning rate: 0.0071875
Epoch 15 - avg_train_loss: 1.2965             avg_val_loss: 1.3008  time: 361s
Epoch 15 - Accuracy: 0.8953271028037383 - F1-score 0.8946979313302953
Epoch 15 - Save Best Accuracy: 0.8953 -                 Save Best F1-score: 0.8947 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 1.2938             avg_val_loss: 1.2984  time: 362s
Epoch 16 - Accuracy: 0.8988317757009345 - F1-score 0.8978696200819524
Epoch 16 - Save Best Accuracy: 0.8988 -                 Save Best F1-score: 0.8979 Model
Number of bad epochs 0
Current learning rate: 0.00409375
Epoch 17 - avg_train_loss: 1.2921             avg_val_loss: 1.2986  time: 362s
Epoch 17 - Accuracy: 0.8995327102803738 - F1-score 0.8983439686498673
Epoch 17 - Save Best Accuracy: 0.8995 -                 Save Best F1-score: 0.8983 Model
Number of bad epochs 0
Current learning rate: 0.0071875
Epoch 18 - avg_train_loss: 1.2924             avg_val_loss: 1.2998  time: 361s
Epoch 18 - Accuracy: 0.8957943925233645 - F1-score 0.8948360456394975
Number of bad epochs 1
Current learning rate: 0.00409375
Epoch 19 - avg_train_loss: 1.2929             avg_val_loss: 1.3001  time: 362s
Epoch 19 - Accuracy: 0.8960280373831776 - F1-score 0.8946065581942463
Number of bad epochs 2
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 1.2907             avg_val_loss: 1.2998  time: 361s
Epoch 20 - Accuracy: 0.8948598130841121 - F1-score 0.8943076094811259
Number of bad epochs 3
Current learning rate: 0.002546875
Epoch 21 - avg_train_loss: 1.2902             avg_val_loss: 1.2997  time: 362s
Epoch 21 - Accuracy: 0.8943925233644859 - F1-score 0.8933973703111967
Number of bad epochs 4
Current learning rate: 0.00409375
Epoch 22 - avg_train_loss: 1.2903             avg_val_loss: 1.3009  time: 362s
Epoch 22 - Accuracy: 0.8953271028037383 - F1-score 0.8950849182810399
Number of bad epochs 5
Current learning rate: 0.002546875
Epoch 23 - avg_train_loss: 1.2899             avg_val_loss: 1.2991  time: 362s
Epoch 23 - Accuracy: 0.8995327102803738 - F1-score 0.8986918566805
Epoch 23 - Save Best Accuracy: 0.8995 -                 Save Best F1-score: 0.8987 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 1.2895             avg_val_loss: 1.3001  time: 362s
Epoch 24 - Accuracy: 0.8955607476635514 - F1-score 0.8948030898182184
Number of bad epochs 1
Current learning rate: 0.0017734375
Epoch 25 - avg_train_loss: 1.2882             avg_val_loss: 1.3005  time: 364s
Epoch 25 - Accuracy: 0.8955607476635514 - F1-score 0.8949080220611442
Number of bad epochs 2
Current learning rate: 0.002546875
Epoch 26 - avg_train_loss: 1.2891             avg_val_loss: 1.3004  time: 363s
Epoch 26 - Accuracy: 0.8957943925233645 - F1-score 0.8951145774863266
Number of bad epochs 3
Current learning rate: 0.0017734375
Epoch 27 - avg_train_loss: 1.2884             avg_val_loss: 1.3006  time: 362s
Epoch 27 - Accuracy: 0.8948598130841121 - F1-score 0.8937285964773156
Number of bad epochs 4
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 1.2878             avg_val_loss: 1.3008  time: 362s
Epoch 28 - Accuracy: 0.8932242990654206 - F1-score 0.8924278065653146
Number of bad epochs 5
Current learning rate: 0.00138671875
Epoch 29 - avg_train_loss: 1.2878             avg_val_loss: 1.3011  time: 361s
Epoch 29 - Accuracy: 0.8932242990654206 - F1-score 0.8922853068446719
Number of bad epochs 6
Current learning rate: 0.0017734375
Epoch 30 - avg_train_loss: 1.2877             avg_val_loss: 1.3013  time: 363s
Epoch 30 - Accuracy: 0.8948598130841121 - F1-score 0.8942252668370295
Number of bad epochs 7
Current learning rate: 0.00138671875
Epoch 31 - avg_train_loss: 1.2867             avg_val_loss: 1.3005  time: 364s
Epoch 31 - Accuracy: 0.8946261682242991 - F1-score 0.893917926763267
Number of bad epochs 8
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 1.2881             avg_val_loss: 1.3012  time: 362s
Epoch 32 - Accuracy: 0.8932242990654206 - F1-score 0.8925563669716293
Number of bad epochs 9
Current learning rate: 0.001193359375
Epoch 33 - avg_train_loss: 1.2880             avg_val_loss: 1.3011  time: 362s
Epoch 33 - Accuracy: 0.8936915887850467 - F1-score 0.8929176519821106
Number of bad epochs 10
Current learning rate: 0.00138671875
Epoch 34 - avg_train_loss: 1.2864             avg_val_loss: 1.3011  time: 362s
Epoch 34 - Accuracy: 0.8936915887850467 - F1-score 0.8925483606379242
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 23: Best Accuracy: 0.8995 -                 Best F1-score: 0.8987
