Reading data...
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 0.8675             avg_val_loss: 0.8117  time: 304s
Epoch 1 - Accuracy: 0.8231308411214954 - F1-score 0.8154015514055479
Epoch 1 - Save Best Accuracy: 0.8231 -                 Save Best F1-score: 0.8154 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 0.7974             avg_val_loss: 0.7444  time: 311s
Epoch 2 - Accuracy: 0.8619158878504672 - F1-score 0.858838358581425
Epoch 2 - Save Best Accuracy: 0.8619 -                 Save Best F1-score: 0.8588 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 0.7755             avg_val_loss: 0.7409  time: 312s
Epoch 3 - Accuracy: 0.8635514018691589 - F1-score 0.8622037356289228
Epoch 3 - Save Best Accuracy: 0.8636 -                 Save Best F1-score: 0.8622 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 0.7653             avg_val_loss: 0.7504  time: 312s
Epoch 4 - Accuracy: 0.8563084112149533 - F1-score 0.8581348975390106
Number of bad epochs 1
Epoch 5 - avg_train_loss: 0.7587             avg_val_loss: 0.7173  time: 312s
Epoch 5 - Accuracy: 0.8731308411214953 - F1-score 0.8720363046134013
Epoch 5 - Save Best Accuracy: 0.8731 -                 Save Best F1-score: 0.8720 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 0.7508             avg_val_loss: 0.7493  time: 312s
Epoch 6 - Accuracy: 0.8577102803738318 - F1-score 0.8589016134234383
Number of bad epochs 1
Epoch 7 - avg_train_loss: 0.7441             avg_val_loss: 0.7228  time: 312s
Epoch 7 - Accuracy: 0.8677570093457944 - F1-score 0.8691197689243974
Number of bad epochs 2
Epoch 8 - avg_train_loss: 0.7403             avg_val_loss: 0.7294  time: 312s
Epoch 8 - Accuracy: 0.872196261682243 - F1-score 0.8735950244828182
Number of bad epochs 3
Epoch 9 - avg_train_loss: 0.7379             avg_val_loss: 0.7175  time: 312s
Epoch 9 - Accuracy: 0.8719626168224299 - F1-score 0.8714767205590838
Number of bad epochs 4
Epoch 10 - avg_train_loss: 0.7299             avg_val_loss: 0.7158  time: 312s
Epoch 10 - Accuracy: 0.8787383177570094 - F1-score 0.8769109267066074
Epoch 10 - Save Best Accuracy: 0.8787 -                 Save Best F1-score: 0.8769 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 0.7271             avg_val_loss: 0.7129  time: 312s
Epoch 11 - Accuracy: 0.8775700934579439 - F1-score 0.8767443538933405
Number of bad epochs 1
Epoch 12 - avg_train_loss: 0.7248             avg_val_loss: 0.7188  time: 312s
Epoch 12 - Accuracy: 0.8785046728971962 - F1-score 0.8745761077357317
Number of bad epochs 2
Epoch 13 - avg_train_loss: 0.7209             avg_val_loss: 0.7100  time: 312s
Epoch 13 - Accuracy: 0.8789719626168224 - F1-score 0.8781118349285664
Epoch 13 - Save Best Accuracy: 0.8790 -                 Save Best F1-score: 0.8781 Model
Number of bad epochs 0
Epoch 14 - avg_train_loss: 0.7175             avg_val_loss: 0.7142  time: 312s
Epoch 14 - Accuracy: 0.8810747663551401 - F1-score 0.8817710419405864
Epoch 14 - Save Best Accuracy: 0.8811 -                 Save Best F1-score: 0.8818 Model
Number of bad epochs 0
Epoch 15 - avg_train_loss: 0.7117             avg_val_loss: 0.6989  time: 312s
Epoch 15 - Accuracy: 0.8859813084112149 - F1-score 0.8857370315740138
Epoch 15 - Save Best Accuracy: 0.8860 -                 Save Best F1-score: 0.8857 Model
Number of bad epochs 0
Epoch 16 - avg_train_loss: 0.7129             avg_val_loss: 0.7136  time: 312s
Epoch 16 - Accuracy: 0.8775700934579439 - F1-score 0.8769293390030403
Number of bad epochs 1
Epoch 17 - avg_train_loss: 0.7144             avg_val_loss: 0.7160  time: 312s
Epoch 17 - Accuracy: 0.8799065420560748 - F1-score 0.8794470363039394
Number of bad epochs 2
Epoch 18 - avg_train_loss: 0.7084             avg_val_loss: 0.7049  time: 312s
Epoch 18 - Accuracy: 0.877803738317757 - F1-score 0.8768152019070936
Number of bad epochs 3
Epoch 19 - avg_train_loss: 0.7072             avg_val_loss: 0.7047  time: 312s
Epoch 19 - Accuracy: 0.8792056074766356 - F1-score 0.8793619975790226
Number of bad epochs 4
Epoch 20 - avg_train_loss: 0.7038             avg_val_loss: 0.7163  time: 312s
Epoch 20 - Accuracy: 0.8728971962616823 - F1-score 0.8719162823997633
Number of bad epochs 5
Epoch 21 - avg_train_loss: 0.7034             avg_val_loss: 0.6968  time: 312s
Epoch 21 - Accuracy: 0.8824766355140187 - F1-score 0.8813059820808115
Number of bad epochs 6
Epoch 22 - avg_train_loss: 0.6990             avg_val_loss: 0.7377  time: 312s
Epoch 22 - Accuracy: 0.8696261682242991 - F1-score 0.871001343309872
Number of bad epochs 7
Epoch 23 - avg_train_loss: 0.6960             avg_val_loss: 0.6967  time: 312s
Epoch 23 - Accuracy: 0.8820093457943925 - F1-score 0.8806631960823726
Number of bad epochs 8
Epoch 24 - avg_train_loss: 0.6938             avg_val_loss: 0.7040  time: 312s
Epoch 24 - Accuracy: 0.8794392523364486 - F1-score 0.8800832618715825
Number of bad epochs 9
Epoch 25 - avg_train_loss: 0.6933             avg_val_loss: 0.7209  time: 312s
Epoch 25 - Accuracy: 0.8684579439252337 - F1-score 0.86929401193319
Number of bad epochs 10
Epoch 26 - avg_train_loss: 0.6895             avg_val_loss: 0.7066  time: 312s
Epoch 26 - Accuracy: 0.8794392523364486 - F1-score 0.8781752888658355
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 15: Best Accuracy: 0.8860 -                 Best F1-score: 0.8857
