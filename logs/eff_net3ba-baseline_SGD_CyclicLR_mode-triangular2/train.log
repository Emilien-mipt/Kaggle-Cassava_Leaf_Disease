Reading data...
Weight list for classes: [1.         0.49657378 0.45557418 0.08261134 0.4218083 ]
Splitting data for training and validation...
train shape:
(17117, 2)
valid shape:
(4280, 2)
train fold:
label
0      870
1     1751
2     1909
3    10526
4     2061
dtype: int64
validation fold:
label
0     217
1     438
2     477
3    2632
4     516
dtype: int64
Model name efficientnet_b3a
Batch size 16
Input size 512
Select LabelSmoothing criterion
Enabling mixed precision for training...
Epoch 1 - avg_train_loss: 1.3757             avg_val_loss: 1.3234  time: 296s
Epoch 1 - Accuracy: 0.8602803738317757 - F1-score 0.8555894534227453
Epoch 1 - Save Best Accuracy: 0.8603 -                 Save Best F1-score: 0.8556 Model
Number of bad epochs 0
Epoch 2 - avg_train_loss: 1.3352             avg_val_loss: 1.3600  time: 300s
Epoch 2 - Accuracy: 0.8628504672897196 - F1-score 0.8608353034444786
Epoch 2 - Save Best Accuracy: 0.8629 -                 Save Best F1-score: 0.8608 Model
Number of bad epochs 0
Epoch 3 - avg_train_loss: 1.3236             avg_val_loss: 1.3107  time: 301s
Epoch 3 - Accuracy: 0.8780373831775701 - F1-score 0.8759190007802646
Epoch 3 - Save Best Accuracy: 0.8780 -                 Save Best F1-score: 0.8759 Model
Number of bad epochs 0
Epoch 4 - avg_train_loss: 1.3093             avg_val_loss: 1.3019  time: 301s
Epoch 4 - Accuracy: 0.888785046728972 - F1-score 0.8872334504201347
Epoch 4 - Save Best Accuracy: 0.8888 -                 Save Best F1-score: 0.8872 Model
Number of bad epochs 0
Epoch 5 - avg_train_loss: 1.3044             avg_val_loss: 1.3034  time: 301s
Epoch 5 - Accuracy: 0.888785046728972 - F1-score 0.8877147110176812
Epoch 5 - Save Best Accuracy: 0.8888 -                 Save Best F1-score: 0.8877 Model
Number of bad epochs 0
Epoch 6 - avg_train_loss: 1.3082             avg_val_loss: 1.3093  time: 301s
Epoch 6 - Accuracy: 0.8852803738317757 - F1-score 0.882850705196566
Number of bad epochs 1
Epoch 7 - avg_train_loss: 1.3058             avg_val_loss: 1.3056  time: 301s
Epoch 7 - Accuracy: 0.8885514018691589 - F1-score 0.8884791633978025
Number of bad epochs 2
Epoch 8 - avg_train_loss: 1.2980             avg_val_loss: 1.3019  time: 301s
Epoch 8 - Accuracy: 0.8913551401869159 - F1-score 0.8907105676003898
Epoch 8 - Save Best Accuracy: 0.8914 -                 Save Best F1-score: 0.8907 Model
Number of bad epochs 0
Epoch 9 - avg_train_loss: 1.2940             avg_val_loss: 1.3011  time: 301s
Epoch 9 - Accuracy: 0.8904205607476635 - F1-score 0.8892005668296876
Number of bad epochs 1
Epoch 10 - avg_train_loss: 1.2975             avg_val_loss: 1.3038  time: 301s
Epoch 10 - Accuracy: 0.891588785046729 - F1-score 0.8907285608212386
Epoch 10 - Save Best Accuracy: 0.8916 -                 Save Best F1-score: 0.8907 Model
Number of bad epochs 0
Epoch 11 - avg_train_loss: 1.2961             avg_val_loss: 1.3019  time: 301s
Epoch 11 - Accuracy: 0.8911214953271028 - F1-score 0.8895072209854363
Number of bad epochs 1
Epoch 12 - avg_train_loss: 1.2906             avg_val_loss: 1.3006  time: 301s
Epoch 12 - Accuracy: 0.8899532710280373 - F1-score 0.8889132575342559
Number of bad epochs 2
Epoch 13 - avg_train_loss: 1.2869             avg_val_loss: 1.3013  time: 301s
Epoch 13 - Accuracy: 0.8885514018691589 - F1-score 0.8870838357764212
Number of bad epochs 3
Epoch 14 - avg_train_loss: 1.2915             avg_val_loss: 1.3034  time: 301s
Epoch 14 - Accuracy: 0.8880841121495328 - F1-score 0.8880874770445123
Number of bad epochs 4
Epoch 15 - avg_train_loss: 1.2883             avg_val_loss: 1.3038  time: 301s
Epoch 15 - Accuracy: 0.8873831775700934 - F1-score 0.8866681838890438
Number of bad epochs 5
Epoch 16 - avg_train_loss: 1.2845             avg_val_loss: 1.3027  time: 301s
Epoch 16 - Accuracy: 0.889018691588785 - F1-score 0.888257879978009
Number of bad epochs 6
Epoch 17 - avg_train_loss: 1.2846             avg_val_loss: 1.3029  time: 301s
Epoch 17 - Accuracy: 0.8904205607476635 - F1-score 0.8895526890458478
Number of bad epochs 7
Epoch 18 - avg_train_loss: 1.2843             avg_val_loss: 1.3023  time: 301s
Epoch 18 - Accuracy: 0.8941588785046729 - F1-score 0.8934293495030181
Epoch 18 - Save Best Accuracy: 0.8942 -                 Save Best F1-score: 0.8934 Model
Number of bad epochs 0
Epoch 19 - avg_train_loss: 1.2846             avg_val_loss: 1.3034  time: 301s
Epoch 19 - Accuracy: 0.8920560747663552 - F1-score 0.8909233912559668
Number of bad epochs 1
Epoch 20 - avg_train_loss: 1.2819             avg_val_loss: 1.3033  time: 301s
Epoch 20 - Accuracy: 0.8883177570093458 - F1-score 0.8871925770137344
Number of bad epochs 2
Epoch 21 - avg_train_loss: 1.2828             avg_val_loss: 1.3039  time: 301s
Epoch 21 - Accuracy: 0.8873831775700934 - F1-score 0.8871671877741082
Number of bad epochs 3
Epoch 22 - avg_train_loss: 1.2818             avg_val_loss: 1.3038  time: 301s
Epoch 22 - Accuracy: 0.8906542056074767 - F1-score 0.889815156705374
Number of bad epochs 4
Epoch 23 - avg_train_loss: 1.2815             avg_val_loss: 1.3035  time: 301s
Epoch 23 - Accuracy: 0.8871495327102804 - F1-score 0.8860753686893929
Number of bad epochs 5
Epoch 24 - avg_train_loss: 1.2804             avg_val_loss: 1.3034  time: 301s
Epoch 24 - Accuracy: 0.8878504672897196 - F1-score 0.8872410373578188
Number of bad epochs 6
Epoch 25 - avg_train_loss: 1.2802             avg_val_loss: 1.3040  time: 301s
Epoch 25 - Accuracy: 0.8883177570093458 - F1-score 0.8873977276101837
Number of bad epochs 7
Epoch 26 - avg_train_loss: 1.2801             avg_val_loss: 1.3040  time: 301s
Epoch 26 - Accuracy: 0.8873831775700934 - F1-score 0.8863381177900567
Number of bad epochs 8
Epoch 27 - avg_train_loss: 1.2809             avg_val_loss: 1.3046  time: 301s
Epoch 27 - Accuracy: 0.8871495327102804 - F1-score 0.885932590713032
Number of bad epochs 9
Epoch 28 - avg_train_loss: 1.2793             avg_val_loss: 1.3044  time: 301s
Epoch 28 - Accuracy: 0.8876168224299066 - F1-score 0.8863094165902251
Number of bad epochs 10
Epoch 29 - avg_train_loss: 1.2791             avg_val_loss: 1.3041  time: 301s
Epoch 29 - Accuracy: 0.888785046728972 - F1-score 0.888146978805658
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 18: Best Accuracy: 0.8942 -                 Best F1-score: 0.8934
